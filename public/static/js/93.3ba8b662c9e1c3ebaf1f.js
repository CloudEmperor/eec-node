webpackJsonp([93],{Agok:function(t,e){},SKDk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"DataSource",data:function(){return{icon:"el-icon-refresh",edition:"",active:1,uploadDisabled:!1,uploadUrl:"",dialogVisible:!1,pageTitle:"数据源管理",tableData:[{id:1,name:"班级信息",desc:"维护班级管理信息"},{id:2,name:"教师信息",desc:"维护教师管理信息"},{id:3,name:"学生信息",desc:"维护学生管理信息"},{id:4,name:"课程信息",desc:"维护课程信息，课程信息必须关联课程大纲版本"},{id:5,name:"排课信息",desc:"维护每学期课程安排，排课信息必须关联学年及学期"}],versionOptions:[],flag:0,uploadData:{}}},mounted:function(){},watch:{active:function(t){this.icon=2===t?"el-icon-loading":"el-icon-refresh"}},methods:{headInfo:function(t){this.pageTitle=t[1]},handleClick:function(){if(4===this.flag&&!this.edition)return this.uploadDisabled=!0,this.$notify.warning({title:"提示",message:"请选择培养方案版本!"}),!1;4===this.flag?this.uploadData={versionId:this.edition}:this.uploadData={},this.uploadDisabled=!1},download:function(t){switch(t.id){case 1:location.href=this.API_URL+"/basic/import/template/classInformation";break;case 2:location.href=this.API_URL+"/basic/import/template/teacher";break;case 3:location.href=this.API_URL+"/basic/import/template/student";break;case 4:location.href=this.API_URL+"/basic/import/template/courseInformation";break;case 5:location.href=this.API_URL+"/basic/import/template/courseScheduling"}},importData:function(t){var e=this;this.flag=t.id,this.active=1,this.dialogVisible=!0,this.edition="",4===t.id&&this.$get("basic/version/all").then(function(t){1===t.status?e.versionOptions=t.data:e.$notify.error({title:"error",duration:1500,message:"获取培养方案版本失败！请刷新重试"})}).catch(function(t){e.$notify.error({title:"error",duration:1500,message:"获取培养方案版本失败！请刷新重试"})});var i=localStorage.getItem("x_token");switch(t.id){case 1:this.uploadUrl=this.API_URL+"/basic/import/classInformation?x-token="+i;break;case 2:this.uploadUrl=this.API_URL+"/basic/import/teacher?x-token="+i;break;case 3:this.uploadUrl=this.API_URL+"/basic/import/student?x-token="+i;break;case 4:this.uploadUrl=this.API_URL+"/basic/import/courseInformation?x-token="+i;break;case 5:this.uploadUrl=this.API_URL+"/basic/import/courseScheduling?x-token="+i}this.$nextTick(function(){e.$refs.uploadXls.clearFiles()})},handleExceed:function(t,e){this.$notify.warning({title:"提示",message:"当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件"})},onProgress:function(){this.active=2,this.uploadDisabled=!0},handleSuccess:function(t){var e=this;console.log(t),1===t.status?(this.$notify.success({title:"提示",message:"导入成功!"}),this.active=3,this.uploadDisabled=!1):(t.data?this.$notify.error({title:"提示",message:"导入失败!"+t.data[0].message}):this.$notify.error({title:"提示",message:t.message}),this.active=1,this.uploadDisabled=!1),this.$nextTick(function(){e.$refs.uploadXls.clearFiles()})},onError:function(){var t=this;this.$notify.error({title:"提示",message:"上传失败!请尝试重新上传!"}),this.active=1,this.uploadDisabled=!1,this.$nextTick(function(){t.$refs.uploadXls.clearFiles()})}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"center studentLearningStatus"},[i("div",{staticClass:"center_breadcrumb"},[i("Crumb",{on:{headInfo:t.headInfo}})],1),t._v(" "),i("div",{staticClass:"center_content"},[i("div",{staticClass:"center_content_title"},[i("SvgIcon",{attrs:{"icon-class":"icondatixitongguanli",size:"20px"}}),t._v(" "),i("span",[t._v(t._s(t.pageTitle))])],1),t._v(" "),i("div",{staticClass:"table-container"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"name",align:"center",label:"数据名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"desc",align:"center",label:"数据描述"}}),t._v(" "),i("el-table-column",{attrs:{label:"数据模板",width:"240",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"operate-button distance"},[i("i",{staticClass:"el-icon-download",staticStyle:{"font-size":"16px"}}),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.download(e.row)}}},[t._v("\n               下载模板\n               ")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"导入数据",width:"240",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"operate-button distance"},[i("i",{staticClass:"el-icon-document",staticStyle:{"font-size":"16px"}}),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.importData(e.row)}}},[t._v("\n               导入数据\n               ")])],1)]}}])})],1)],1)]),t._v(" "),i("el-dialog",{staticClass:"set-el-dialog set-course-dialog",attrs:{title:"导入数据",visible:t.dialogVisible,width:"35%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticStyle:{height:"400px"}},[i("div",{staticStyle:{height:"400px","min-width":"280px",width:"50%",float:"left"}},[i("el-steps",{attrs:{direction:"vertical",active:t.active}},[i("el-step",{attrs:{title:"上传文件",icon:"el-icon-upload"}}),t._v(" "),i("el-step",{attrs:{title:"检查数据",icon:t.icon,description:"等待文件上传完毕后自动检查表格数据。"}}),t._v(" "),i("el-step",{attrs:{title:"完成",icon:"el-icon-success"}})],1)],1),t._v(" "),i("div",{staticStyle:{position:"absolute",top:"105px",left:"85px"}},[4===t.flag?i("div",{staticStyle:{height:"50px","line-height":"50px"}},[i("label",[i("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("培养方案版本:  ")]),t._v(" "),i("el-select",{attrs:{placeholder:"请选择培养方案版本",size:"mini"},model:{value:t.edition,callback:function(e){t.edition=e},expression:"edition"}},t._l(t.versionOptions,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1):t._e(),t._v(" "),i("p",{staticStyle:{padding:"10px 0","font-size":"12px"}},[t._v("导入数据前，请先下载模板，按照模板格式录入数据。")]),t._v(" "),i("div",{staticClass:"file-upload"},[i("el-upload",{ref:"uploadXls",staticClass:"upload-demo",attrs:{disabled:t.uploadDisabled,action:t.uploadUrl,"on-success":t.handleSuccess,"on-progress":t.onProgress,"on-error":t.onError,limit:1,"show-file-list":!1,accept:".xls,.xlsx",name:"file",data:t.uploadData,"on-exceed":t.handleExceed}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleClick}},[i("i",{staticClass:"el-icon-upload el-icon--right"}),t._v("  上传文件")]),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("支持文件格式：.xls .xlsx。")])],1)],1)])])])],1)},staticRenderFns:[]};var l=i("C7Lr")(a,s,!1,function(t){i("Agok")},null,null);e.default=l.exports}});
//# sourceMappingURL=93.3ba8b662c9e1c3ebaf1f.js.map