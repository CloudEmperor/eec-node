webpackJsonp([129],{twK6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("g416"),n={name:"GraduationRequirements",data:function(){var t=this;return{pageTitle:"毕业要求",pageTitleArr:[],data:{},tableData:[],versionOptions:[],goalAllOptions:[],activeIndex:0,isAdd:!0,isSubmit:!1,userDialogFormVisible:!1,page:{versionId:"",page:1,rows:15},form:{name:"",versionId:"",goalSuIDs:[],code:"",content:"",id:void 0,indexPoints:[{content:""}]},rules:{name:[{required:!0,message:"请输入毕业要求名称",trigger:"blur"}],versionId:[{required:!0,message:"请选择培养方案版本",trigger:"blur"}],goalSuIDs:[{required:!0,message:"请选择培养目标",trigger:"blur"}],code:[{required:!0,message:"请输入毕业要求编号",trigger:"blur"}],minimum:[{required:!0,validator:function(t,e,i){return 0!==e&&e?e<0||e>1?i(new Error("目标达成值范围0-1之间")):void i():i(new Error("请输入目标达成值"))},trigger:"blur"}],point:[{required:!0,validator:function(e,i,o){var n=0;if(t.form.indexPoints.forEach(function(t){t.content||n++}),n>0)return o(new Error("请输入课程目标及课程目标内容"));o()},trigger:"blur"}]}}},created:function(){},mounted:function(){this.versionAll(),this.getList()},computed:{dialogTitle:function(){return this.isAdd?"添加毕业要求":"编辑毕业要求"}},methods:{addPoint:function(){this.form.indexPoints.push({content:""})},deletePoint:function(t){this.form.indexPoints.splice(t,1)},getList:function(){var t=this;localStorage.getItem("versionId")?(this.page.versionId=localStorage.getItem("versionId"),this.initData()):setTimeout(function(){t.getList()},200)},initData:function(){var t=this,e=o.a.claimList;this.$post(e,this.page).then(function(e){1===e.status?(t.data=e,t.tableData=e.data):t.$notify.error({title:"error",duration:1500,message:e.message})}).catch(function(t){console.log(t)})},versionAll:function(){var t=this,e=o.a.versionAll;this.$get(e).then(function(e){1===e.status?t.versionOptions=e.data:t.$notify.error({title:"error",duration:1500,message:e.message})}).catch(function(t){console.log(t)})},goalAll:function(t){var e=this,i=o.a.goalAll({versionId:t});this.$get(i).then(function(t){1===t.status?e.goalAllOptions=t.data:e.$notify.error({title:"error",duration:1500,message:t.message})}).catch(function(t){console.log(t)})},headInfo:function(t){this.pageTitle=t[1],this.pageTitleArr=t},handleSizeChange:function(t){this.page.rows=t,this.initData()},handleCurrentChange:function(t){this.page.page=t,this.initData()},search:function(t,e){this.activeIndex=e,this.page.page=1,this.page.versionId=t.id,localStorage.setItem("versionIdss",t.id),this.initData()},openAdd:function(){var t=this;this.userDialogFormVisible=!0,this.$nextTick(function(){t.form={name:"",versionId:localStorage.getItem("versionId"),goalSuIDs:[],code:"",content:"",id:void 0,indexPoints:[{content:""}]},t.goalAll(t.form.versionId),t.isAdd=!0,t.isSubmit=!1,t.$refs.form.resetFields()})},versionSelect:function(t){this.form.goalSuIDs=[],this.goalAll(t)},deleteRow:function(t){var e=this;this.$confirm("确定删除该毕业要求?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.userDel(t.id)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},editRow:function(t){this.goalAll(t.versionId);var e=[];t.chlids.forEach(function(t){e.push({content:t.content})});var i={name:t.name,versionId:t.versionId,goalSuIDs:t.goalSuIDs,code:t.code,content:t.content,id:t.id,indexPoints:e};this.form=i,this.userDialogFormVisible=!0,this.isAdd=!1,this.isSubmit=!1},disintegrateRow:function(t){this.$router.push({path:"/trainingProgram/disintegrate",query:{title:t.name,code:t.code,id:t.id,pageTitle:this.pageTitleArr}})},create:function(t){var e=this;this.$refs[t].validate(function(t){t&&(e.isSubmit=!0,e.form.indexPoints.forEach(function(t,e){t.code=e+1}),e.isAdd?e.userAdd():e.userEdit())})},cancel:function(t){this.userDialogFormVisible=!1,this.$refs[t].resetFields()},handleDialogClose:function(){this.$refs.form.resetFields(),this.userDialogFormVisible=!1},userAdd:function(){var t=this,e=o.a.claimAdd;this.$post(e,this.form).then(function(e){1===e.status?(t.isSubmit=!0,t.$notify.success({title:"success",duration:1500,message:e.message}),t.userDialogFormVisible=!1,t.initData()):(t.isSubmit=!1,t.$notify.error({title:"error",duration:1500,message:e.message}))}).catch(function(e){t.isSubmit=!1,console.log(e)})},userDel:function(t){var e=this,i=o.a.claimDel({id:t});this.$deletes(i).then(function(t){1===t.status?(e.$notify.success({title:"success",duration:1500,message:t.message}),e.initData()):e.$notify.error({title:"error",duration:1500,message:t.message})}).catch(function(t){console.log(t)})},userEdit:function(){var t=this,e=o.a.claimEdit;this.$put(e,this.form).then(function(e){1===e.status?(t.isSubmit=!0,t.$notify.success({title:"success",duration:1500,message:e.message}),t.userDialogFormVisible=!1,t.initData()):(t.isSubmit=!1,t.$notify.error({title:"error",duration:1500,message:e.message}))}).catch(function(e){t.isSubmit=!1,console.log(e)})}}},s={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"center requirements"},[o("div",{staticClass:"center_breadcrumb"},[o("crumb",{staticStyle:{padding:"0 5px"}},[o("div",{staticClass:"new--btn",attrs:{slot:"right"},on:{click:t.openAdd},slot:"right"},[t._v("+ 新建")])])],1),t._v(" "),o("div",{staticClass:"center_content"},[o("div",{staticClass:"table-container"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("ul",t._l(e.row.chlids,function(e,n){return o("li",{key:n,staticClass:"targetItem",attrs:{title:e.content}},[o("div",{staticClass:"index"},[o("img",{attrs:{src:i("R+3m"),alt:""}}),t._v(" "),o("span",[t._v(t._s(e.code))])]),t._v(" "),o("div",{staticStyle:{"padding-left":"60px"}},[o("div",{staticClass:"itemContent"},[t._v("指标点"+t._s(e.code)+"："+t._s(e.content))]),t._v(" "),o("div",{staticStyle:{overflow:"hidden"}})])])}),0)]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"code",label:"编号",align:"center",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{prop:"content",label:"毕业要求内容"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"毕业要求简称",width:"220"}}),t._v(" "),o("el-table-column",{attrs:{prop:"goalVal",label:"支撑目标",width:"220"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"operate-button distance"},[o("SvgIcon",{attrs:{"icon-class":"iconbianji1"}}),t._v(" "),o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.editRow(e.row)}}},[t._v("编辑")])],1),t._v(" "),o("div",{staticClass:"operate-button distance"},[o("SvgIcon",{attrs:{"icon-class":"iconshanchu"}}),t._v(" "),o("el-button",{staticStyle:{color:"#ff5858"},attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.deleteRow(e.row)}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),o("div",{staticClass:"center_pagination"},[o("el-pagination",{attrs:{background:"","current-page":t.page.page,"page-sizes":[15,30,40,50],"page-size":t.page.rows,layout:"prev, pager, next, jumper, sizes, total",total:t.data.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),o("el-dialog",{staticClass:"set-el-dialog",attrs:{title:t.dialogTitle,visible:t.userDialogFormVisible,"before-close":t.handleDialogClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.userDialogFormVisible=e}}},[o("el-form",{ref:"form",staticStyle:{"padding-right":"50px"},attrs:{model:t.form,rules:t.rules,"label-width":"130px"}},[o("el-form-item",{attrs:{label:"培养方案版本",prop:"versionId"}},[o("el-select",{attrs:{placeholder:"请选择",disabled:""},on:{change:t.versionSelect},model:{value:t.form.versionId,callback:function(e){t.$set(t.form,"versionId",e)},expression:"form.versionId"}},t._l(t.versionOptions,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"支撑目标",prop:"goalSuIDs"}},[o("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:t.form.goalSuIDs,callback:function(e){t.$set(t.form,"goalSuIDs",e)},expression:"form.goalSuIDs"}},t._l(t.goalAllOptions,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"毕业要求编号",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"毕业要求内容",prop:"content"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"毕业要求简称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"毕业要求指标点",prop:"point"}},[t._l(this.form.indexPoints,function(e,i){return o("el-row",{key:i,staticStyle:{position:"relative","margin-bottom":"20px"}},[o("el-col",{attrs:{span:2}},[o("div",{staticStyle:{width:"50px",border:"1px solid #dcdfe6","text-align":"center","border-radius":"5px","background-color":"#f8f8f8"}},[t._v(t._s(i+1))])]),t._v(" "),o("el-col",{attrs:{span:21,offset:1}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.content,callback:function(i){t.$set(e,"content",i)},expression:"item.content"}})],1),t._v(" "),0!==i?o("i",{staticClass:"el-icon-circle-close",staticStyle:{"font-size":"21px",position:"absolute",right:"-30px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",color:"#aaa"},on:{click:function(e){return t.deletePoint(i)}}}):t._e()],1)}),t._v(" "),o("div",{staticStyle:{cursor:"pointer"},on:{click:t.addPoint}},[o("i",{staticClass:"el-icon-plus",staticStyle:{color:"#03b187","font-weight":"700"}}),t._v(" "),o("span",[t._v("添加毕业要求指标点")])])],2)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){return t.cancel("form")}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary",disabled:t.isSubmit},on:{click:function(e){return t.create("form")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var a=i("C7Lr")(n,s,!1,function(t){i("yA57")},null,null);e.default=a.exports},yA57:function(t,e){}});
//# sourceMappingURL=129.62cd88d70e8da4839a7f.js.map