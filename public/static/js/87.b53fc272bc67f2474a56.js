webpackJsonp([87],{N3cV:function(e,t){},yVP6:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s("7Adc");var a={data:function(){return{fullWidth:document.documentElement.clientWidth,pageTitle:["成绩管理","成绩管理"],dialogFormVisible:!1,isOperate:this.$route.query.type,roleName:localStorage.getItem("roleName"),formLabelWidth:"120px",currentPage4:1,pageSize:15,total:0,file:"",index:1,fileList:[],formInline:{user:""},finishType:"",importOptions:[{name:"全部",id:""},{name:"已导入",id:"已导入"},{name:"未导入",id:"未导入"}],tableData1:[],tableData:[],options:[],value:"",options1:[],value1:"",options2:[],value2:"",teacherssId:{},form:{file:""},arr:"",api:{startInvestigation:"/form/rest/FormMainBaseBusiness/startCourseInvestigation/v1"}}},methods:{submitUpload:function(){3===this.index&&(this.dialogFormVisible=!1,this.index=1)},uploadUrl:function(){var e=localStorage.getItem("x_token");if(this.teacherssId.classIds)return this.API_URL+"/teacher/course/upload?x-token="+e+"&courseId="+this.teacherssId.courseId+"&classIds="+this.teacherssId.classIds.join(",")+"&grade="+this.teacherssId.grade},handleRemove:function(e,t){this.form.file=""},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件"),e.size>20480&&this.$message.warning("sorry 上传文件大于20M,请重新上")},handleSuccess:function(e,t,s){200===e.code?(this.$notify.success({title:"success",message:e.message}),this.index=3):(this.$message({type:"info",message:e.message}),this.index=2)},handleError:function(e,t,s){},beforeRemove:function(e,t){3===this.index&&(this.index=1),this.$confirm("确定移除 "+e.name+"？")},onSubmit:function(){var e=this,t=this.value,s=this.value1,a=this.value2,i=this.formInline.user,l=this.currentPage4,n=this.pageSize,o=localStorage.getItem("versionId"),r=this.finishType;this.$post("/teacher/mycourse/getall",{grade:t,term:s,className:a,courseName:i,pageNum:l,pageSize:n,versionId:o,finishType:r}).then(function(t){e.tableData=t.list,e.total=t.rowCount})},luiii:function(e){"请选择"==e?(this.options1=[],this.options1.push("请选择")):(this.arr="abc",this.getall())},getall:function(){var e=this,t={grade:this.value,term:this.value1,className:this.value2,courseName:this.formInline.user,pageNum:this.currentPage4,pageSize:this.pageSize,versionId:localStorage.getItem("versionId")};this.$post("/teacher/mycourse/getall",t).then(function(t){if(1==t.success){e.tableData=t.list,e.total=t.rowCount;var s=[],a=[],i=[];t.grades.forEach(function(e){s.push(e.grade)}),e.options=s,t.classes.forEach(function(e){a.push(e.className)}),e.options2=a,"abc"==e.arr&&(t.terms.forEach(function(e){i.push(e.courseTerm)}),e.options1=i)}})},handleEdit:function(e,t){},seccons4:function(){this.dialogFormVisible=!1},close:function(){this.dialogFormVisible=!0},change:function(e,t){var s=t.courseId;this.$router.push({path:"/teachers/weihu",query:{id:s}})},jump:function(e,t){this.$router.push({path:"/studentside/graduation",query:{id:e,schedulingId:t}})},xiazai:function(){var e=localStorage.getItem("x_token");window.location.href=this.API_URL+"/teacher/course/downmodel?x-token="+e+"&courseId="+this.teacherssId.courseId+"&classIds="+this.teacherssId.classIds.join(",")+"&grade="+this.teacherssId.grade},handleDelete:function(e,t){this.dialogFormVisible=!0,this.teacherssId=t},handleStart:function(e){var t=this;this.$confirm("确认发起"+e.courseName+"的达成评价?","确认提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s={formId:e.formId,classIds:e.classIds.join(",")};t.$post(t.api.startInvestigation,s).then(function(e){200===e.code&&t.$notify.success({title:"success",duration:1500,message:"操作成功"})})})},handleSizeChange:function(e){this.pageSize=e,this.getall()},handleCurrentChange:function(e){this.currentPage4=e,this.getall()}},mounted:function(){this.getall()}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"teachersifon padding students"},["taskSituation"===e.isOperate?s("crumb",{attrs:{data:e.pageTitle}}):s("crumb",{staticStyle:{padding:"0 5px"}}),e._v(" "),s("div",{staticClass:"teachersifon-inp"},[s("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[s("el-row",[s("el-col",{attrs:{span:1920==e.fullWidth?22:24}},[s("span",{staticClass:"ssssss"},[e._v("学年：")]),e._v(" "),s("el-select",{staticClass:"pppp",style:{width:1920==e.fullWidth?"15%":"18%"},attrs:{placeholder:"请选择学年"},on:{change:e.luiii},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return s("el-option",{key:e,attrs:{label:e+"学年",value:e}})}),1),e._v(" "),s("span",{staticClass:"sssss"},[e._v("学期：")]),e._v(" "),s("el-select",{staticClass:"pppp",style:{width:1920==e.fullWidth?"15%":"18%"},attrs:{placeholder:"请先选择学年"},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1),e._v(" "),s("span",{staticClass:"sssss"},[e._v("代课班级：")]),e._v(" "),s("el-select",{staticClass:"pppp",style:{width:1920==e.fullWidth?"15%":"18%"},attrs:{placeholder:"全部"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options2,function(e){return s("el-option",{key:e.id,attrs:{label:e,value:e}})}),1),e._v(" "),s("span",{staticClass:"sssss"},[e._v("导入情况：")]),e._v(" "),s("el-select",{staticClass:"pppp",style:{width:1920==e.fullWidth?"15%":"18%"},attrs:{placeholder:"全部"},model:{value:e.finishType,callback:function(t){e.finishType=t},expression:"finishType"}},e._l(e.importOptions,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),1920==e.fullWidth?s("span",{staticClass:"sssss"},[e._v("代课班级：")]):e._e(),e._v(" "),1920==e.fullWidth?s("el-input",{staticClass:"pppp",style:{width:1920==e.fullWidth?"15%":"18%"},attrs:{placeholder:"请输入搜索关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}}):e._e()],1),e._v(" "),1920==e.fullWidth?s("el-col",{attrs:{span:2}},[s("div",{staticClass:"search--btn",staticStyle:{margin:"5px 0 0 20px"},on:{click:e.onSubmit}},[e._v("搜索")])]):e._e()],1),e._v(" "),1920!==e.fullWidth?s("el-row",[s("el-col",{attrs:{span:6}},[s("span",{staticClass:"sssss",staticStyle:{"margin-left":"0px"}},[e._v("代课班级：")]),e._v(" "),s("el-input",{staticClass:"pppp",staticStyle:{width:"70%"},attrs:{placeholder:"请输入搜索关键词"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"search--btn",staticStyle:{margin:"5px 0 0 20px"},on:{click:e.onSubmit}},[e._v("搜索")])])],1):e._e()],1)],1),e._v(" "),s("div",{staticClass:"teachersifon-tab"},[[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[s("el-table-column",{attrs:{label:"课程编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.courseCode))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"课程名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticStyle:{cursor:"pointer"},on:{click:function(s){return e.jump(t.row.courseId,t.row.schedulingId)}}},[s("span",[e._v(e._s(t.row.courseName))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"课程类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.courseClassification))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"是否导入"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.exportFinish))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"年级"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.grade))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"带课班级"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.className))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"考核方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.courseExamine))])]}}])}),e._v(" "),"taskSituation"!==e.isOperate?s("el-table-column",{attrs:{label:"操作",width:"330"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}},[s("svgIcon",{attrs:{"icon-class":"icondaochu-excel"}}),e._v("  导入成绩\n            ")],1),e._v(" "),"教师"!==e.roleName&&"课程负责人"!==e.roleName?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return e.change(t.$index,t.row)}}},[s("svgIcon",{attrs:{"icon-class":"iconnav-xitongguanli"}}),e._v("  维护课程目标成绩关系\n            ")],1):e._e(),e._v(" "),"教师"===e.roleName&&"null"!==t.row.formId&&1===t.row.formStatus?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return e.handleStart(t.row)}}},[s("svgIcon",{attrs:{"icon-class":"icondaochu-excel"}}),e._v(" 发起调查\n            ")],1):e._e()]}}],null,!1,3494918650)}):e._e()],1),e._v(" "),s("div",[s("form",{attrs:{model:e.form,enctype:"Content-Type: multipart/form-data"}},[s("el-dialog",{attrs:{title:"导入成绩",visible:e.dialogFormVisible,"show-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("div",{staticClass:"steps-dv1",staticStyle:{height:"350px"}},[s("el-steps",{attrs:{active:e.index,direction:"vertical"}},[s("el-step",{attrs:{title:"上传文件",icon:"el-icon-edit"}},[s("template",{slot:"description"},[s("div",[e._v("\n                      导入学生成绩之前，请先“\n                      "),s("span",{staticClass:"span-dv",on:{click:e.xiazai}},[e._v("下载模板")]),e._v("”，按照模板格式录入数据。\n                    ")])])],2),e._v(" "),s("el-step",{attrs:{title:"检查数据",icon:"el-icon-upload",description:"等待文件上传完毕后自动检查表格数据。"}},[s("template",{slot:"description"},[s("div",[e._v("等待文件上传完毕后自动检查表格数据。")])])],2),e._v(" "),s("el-step",{attrs:{title:"完成",icon:"el-icon-picture"}})],1),e._v(" "),s("el-upload",{ref:"upload",staticClass:"upload-demo steps-btn",attrs:{action:e.uploadUrl(),accept:".xls","on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!0,"on-success":e.handleSuccess,"on-error":e.handleError,"before-remove":e.beforeRemove,limit:1,"on-exceed":e.handleExceed}},[s("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("上传")]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持文件格式：.xls 类型的文件，且不超过20M")])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("确 定")])],1)])],1)])]],2),e._v(" "),s("div",[[s("div",{staticClass:"block"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage4,"page-sizes":[15,30,40,50],"page-size":e.pageSize,layout:"prev, pager, next, jumper, sizes, total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]],2)],1)},staticRenderFns:[]};var l=s("C7Lr")(a,i,!1,function(e){s("N3cV")},null,null);t.default=l.exports}});
//# sourceMappingURL=87.b53fc272bc67f2474a56.js.map