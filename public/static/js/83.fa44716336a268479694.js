webpackJsonp([83],{E00d:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("aA9S"),s=a.n(i),l={components:{Crumb:a("fcG9").a},data:function(){return{academyOption:[],specialtyOption:[{id:"",name:"请先选择所属学院"}],classOption:[{id:"",name:"请先选择所属专业"}],academyOption1:[],specialtyOption1:[{id:"",name:"请先选择所属学院"}],classOption1:[{id:"",name:"请先选择所属专业"}],formLabelWidth:"120px",dialogFormVisible:!1,icon:"el-icon-refresh",dialogVisible:!1,uploadDisabled:!1,uploadUrl:"",active:1,enterpriseOption:[],listQuery:{grade:null,academyId:"",specialtyId:"",slaveClassCode:"",academyName:"",page:1,rows:15},academyName:"",form:{studentCode:"",name:"",academyId:"",specialtyId:"",grade:"",slaveClassCode:"",workUnit:"",email:"",phone:""},options:[],options1:[],tableData:[],total:0,title:"添加校友信息",rules:{studentCode:[{required:!0,message:"请输入学号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],academyId:[{required:!0,message:"请选择所属学院",trigger:"change"}],specialtyId:[{required:!0,message:"请选择所属专业",trigger:"change"}],grade:[{required:!0,message:"请选择入学年级",trigger:"change"}],slaveClassCode:[{required:!0,message:"请选择分流班级",trigger:"change"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],phone:[{validator:function(e,t,a){""===t?a():/^[1][3,4,5,7,8][0-9]{9}$/.test(t)?a():a(new Error("请输入正确的手机号码"))},trigger:"blur"}]},loading:!1,bodyLoading:!0,flag:!0}},computed:{academyIdOfQuery:function(){return this.listQuery.academyId},specialtyIdOfQuery:function(){return this.listQuery.specialtyId},academyIdOfForm:function(){return this.form.academyId},specialtyIdOfForm:function(){return this.form.specialtyId}},watch:{academyIdOfQuery:function(e){e?(this.getSpecialty(e,1),this.listQuery.specialtyId="",this.listQuery.slaveClassCode=""):(this.specialtyOption=[{id:"",name:"请先选择所属学院"}],this.listQuery.specialtyId="",this.classOption=[{id:"",name:"请先选择所属专业"}],this.listQuery.slaveClassCode="")},specialtyIdOfQuery:function(e){e?(this.getClass(e,1),this.listQuery.slaveClassCode=""):(this.classOption=[{id:"",name:"请先选择所属专业"}],this.listQuery.slaveClassCode="")},academyIdOfForm:function(e){e?(this.getSpecialty(e,0),this.flag||(this.form.specialtyId="",this.form.slaveClassCode="")):(this.specialtyOption1=[{id:"",name:"请先选择所属学院"}],this.form.specialtyId="",this.classOption1=[{id:"",name:"请先选择所属专业"}],this.form.slaveClassCode="")},specialtyIdOfForm:function(e){e?(this.getClass(e,0),this.flag||(this.form.slaveClassCode="")):(this.classOption1=[{id:"",name:"请先选择所属专业"}],this.form.slaveClassCode="")}},mounted:function(){this.getList(),this.getGrade(),this.getacademy()},methods:{resetListQuery:function(){this.listQuery={grade:"",academyId:"",specialtyId:"",slaveClassCode:"",academyName:"",page:1,rows:15}},getList:function(){var e=this;this.bodyLoading=!0,this.$post("/basic/alumniInfo/list",this.listQuery).then(function(t){1===t.status?(e.tableData=t.data,e.total=t.total):e.$notify({title:"提示",message:t.message,type:"error",duration:"2000"}),e.bodyLoading=!1}).catch(function(){e.$notify({title:"提示",message:"获取列表失败请重试!",type:"error",duration:"2000"}),e.bodyLoading=!1})},download:function(){location.href=this.API_URL+"/basic/alumniInfo/template/alumniInfo"},getGrade:function(){var e=this;this.$get("basic/class/grades").then(function(t){1===t.status?(e.options=[{id:"",name:"全部"}],t.data.forEach(function(t){e.options.push(t)}),e.options1=t.data):e.$notify({title:"提示",message:t.message,type:"error",duration:"2000"}),e.bodyLoading=!1}).catch(function(){e.$notify({title:"提示",message:"获取所属学院失败请重试!",type:"error",duration:"2000"}),e.bodyLoading=!1})},getacademy:function(){var e=this;this.bodyLoading=!0,this.$get("/basic/academy/all?type=1").then(function(t){1===t.status?(e.academyOption=s()([],t.data),e.academyOption.unshift({id:"",name:"全部"}),e.academyOption1=s()([],t.data)):e.$notify({title:"提示",message:t.message,type:"error",duration:"2000"}),e.bodyLoading=!1}).catch(function(){e.$notify({title:"提示",message:"获取所属学院失败请重试!",type:"error",duration:"2000"}),e.bodyLoading=!1})},getSpecialty:function(e,t){var a=this;this.bodyLoading=!0,this.$get("/basic/specialty/all/"+e).then(function(e){1===e.status?t?(a.specialtyOption=e.data,a.specialtyOption.unshift({id:"",name:"全部"})):a.specialtyOption1=e.data:a.$notify({title:"提示",message:e.message,type:"error",duration:"2000"}),a.bodyLoading=!1}).catch(function(){a.$notify({title:"提示",message:"获取所属班级失败请重试!",type:"error",duration:"2000"}),a.bodyLoading=!1})},getClass:function(e,t){var a=this;this.bodyLoading=!0,this.$get("/basic/class/shuntClassAll",{specialtyId:e,type:1}).then(function(e){1===e.status?t?(a.classOption=e.data,a.classOption.unshift({id:"",name:"全部"})):a.classOption1=e.data:a.$notify({title:"提示",message:e.message,type:"error",duration:"2000"}),a.bodyLoading=!1}).catch(function(){a.$notify({title:"提示",message:"获取所属专业失败请重试!",type:"error",duration:"2000"}),a.bodyLoading=!1})},handleAdd:function(){var e=this;this.flag=!1,this.dialogFormVisible=!0,this.title="添加校友信息",this.getGrade(),this.$nextTick(function(){e.form={studentCode:"",name:"",academyId:"",specialtyId:"",grade:"",slaveClassCode:"",workUnit:"",email:"",phone:""},e.$refs.form.resetFields()})},handleEdit:function(e){var t=this;this.flag=!0,this.dialogFormVisible=!0,this.title="编辑校友信息",this.form={id:e.id,studentCode:e.studentCode,name:e.name,academyId:e.academyId,specialtyId:e.specialtyId,grade:e.grade,slaveClassCode:e.slaveClassCode,workUnit:e.workUnit||"",email:e.email,phone:e.phone},this.getGrade(),this.$nextTick(function(){t.$refs.form.clearValidate(),t.flag=!1})},handleDelete:function(e){var t=this;this.$confirm("此操作将删除该校友信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$post("/basic/alumniInfo/del/"+e.id).then(function(e){1===e.status?(t.$notify({title:"提示",message:e.message,type:"success",duration:"2000"}),t.listQuery.page=1,t.getList()):t.$notify({title:"提示",message:e.message,type:"error",duration:"2000"})}).catch(function(){t.$notify({title:"提示",message:"删除失败！请重试！",type:"error",duration:"2000"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.listQuery.rows=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},submitForm:function(e){var t=this;this.loading=!0,this.$refs[e].validate(function(e){if(!e)return t.loading=!1,!1;t.$post("/basic/alumniInfo/add",t.form).then(function(e){1===e.status?(t.$notify({title:"提示",message:e.message,type:"success",duration:"2000"}),t.dialogFormVisible=!1,t.resetListQuery(),t.getList()):t.$notify({title:"提示",message:e.message,type:"error",duration:"2000"}),t.loading=!1}).catch(function(){t.loading=!1})})},editForm:function(e){var t=this;this.loading=!0,this.$refs[e].validate(function(e){if(!e)return t.loading=!1,!1;t.$post("/basic/alumniInfo/edit",t.form).then(function(e){1===e.status?(t.$notify({title:"提示",message:e.message,type:"success",duration:"2000"}),t.dialogFormVisible=!1,t.resetListQuery(),t.getList()):t.$notify({title:"提示",message:e.message,type:"error",duration:"2000"}),t.loading=!1}).catch(function(){t.loading=!1})})},handleClick:function(){this.uploadDisabled=!1},handleExport:function(){var e=this;this.active=1,this.dialogVisible=!0;var t=localStorage.getItem("x_token");this.uploadUrl=this.API_URL+"/basic/alumniInfo/importAlumniInfo?x-token="+t,this.$nextTick(function(){e.$refs.uploadXls.clearFiles()})},handleExceed:function(e,t){this.$notify.warning({title:"提示",message:"当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件"})},onProgress:function(){this.active=2,this.uploadDisabled=!0},handleSuccess:function(e){var t=this;1===e.status?(this.$notify.success({title:"提示",message:"导入成功!"}),this.active=3,this.uploadDisabled=!1,this.getList()):(e.data?this.$notify.error({title:"提示",message:"导入失败!"+e.data[0].message}):this.$notify.error({title:"提示",message:e.message}),this.active=1,this.uploadDisabled=!1),this.$nextTick(function(){t.$refs.uploadXls.clearFiles()})},onError:function(){var e=this;this.$notify.error({title:"提示",message:"上传失败!请尝试重新上传!"}),this.active=1,this.uploadDisabled=!1,this.$nextTick(function(){e.$refs.uploadXls.clearFiles()})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.bodyLoading,expression:"bodyLoading",modifiers:{body:!0}}],staticClass:"alumniInformation"},[a("div",{staticClass:"mainContainer"},[a("crumb",{staticStyle:{padding:"0 5px"}},[a("div",{staticClass:"new--btn",attrs:{slot:"right"},on:{click:e.handleAdd},slot:"right"},[e._v("+ 新建")]),e._v(" "),a("div",{staticStyle:{float:"left","margin-right":"10px",color:"#03B187",cursor:"pointer"},attrs:{slot:"right",icon:"el-icon-plus"},on:{click:e.handleExport},slot:"right"},[a("SvgIcon",{staticStyle:{float:"left",margin:"32px 5px 0 0"},attrs:{"icon-class":"icondaoru",size:"18px"}}),e._v(" 导入")],1)]),e._v(" "),a("div",{staticClass:"listQuery"},[a("el-form",{ref:"listQuery",attrs:{model:e.listQuery,"label-width":"90px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"入学年级："}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择入学年级",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.grade,callback:function(t){e.$set(e.listQuery,"grade",t)},expression:"listQuery.grade"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"所属学院："}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择所属学院"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.academyId,callback:function(t){e.$set(e.listQuery,"academyId",t)},expression:"listQuery.academyId"}},e._l(e.academyOption,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"所属专业："}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择所属专业"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.specialtyId,callback:function(t){e.$set(e.listQuery,"specialtyId",t)},expression:"listQuery.specialtyId"}},e._l(e.specialtyOption,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"所属班级："}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择所属班级"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.slaveClassCode,callback:function(t){e.$set(e.listQuery,"slaveClassCode",t)},expression:"listQuery.slaveClassCode"}},e._l(e.classOption,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"学院名称："}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入学院名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(t)}},model:{value:e.listQuery.academyName,callback:function(t){e.$set(e.listQuery,"academyName",t)},expression:"listQuery.academyName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"search--btn",on:{click:e.getList}},[e._v("搜索")])])],1)],1)],1),e._v(" "),a("div",{staticClass:"tableBody"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{prop:"studentCode",label:"学号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{label:"入学年份"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.grade+"级")+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"academyName",label:"所属学院"}}),e._v(" "),a("el-table-column",{attrs:{prop:"specialtyName",label:"所属专业"}}),e._v(" "),a("el-table-column",{attrs:{prop:"slaveClassName",label:"所属班级"}}),e._v(" "),a("el-table-column",{attrs:{prop:"workUnit",label:"工作单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEdit(t.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconbianji1"}}),e._v("  编辑\n            ")],1),e._v(" "),a("el-button",{staticStyle:{color:"#ff5858"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconshanchu"}}),e._v("  删除\n            ")],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"pagination"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[15,30,40,50],"page-size":e.listQuery.rows,layout:"prev, pager, next, jumper, sizes, total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"学号：",prop:"studentCode"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入学号",size:"small"},model:{value:e.form.studentCode,callback:function(t){e.$set(e.form,"studentCode",t)},expression:"form.studentCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入姓名",size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属学院：",prop:"academyId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属学院",size:"small"},model:{value:e.form.academyId,callback:function(t){e.$set(e.form,"academyId",t)},expression:"form.academyId"}},e._l(e.academyOption1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属专业：",prop:"specialtyId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属专业",size:"small"},model:{value:e.form.specialtyId,callback:function(t){e.$set(e.form,"specialtyId",t)},expression:"form.specialtyId"}},e._l(e.specialtyOption1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"入学年级：",prop:"grade"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择入学年级",size:"small"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},e._l(e.options1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分流班级：",prop:"slaveClassCode"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择分流班级",size:"small"},model:{value:e.form.slaveClassCode,callback:function(t){e.$set(e.form,"slaveClassCode",t)},expression:"form.slaveClassCode"}},e._l(e.classOption1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"工作单位：",prop:"workUnit"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入工作单位",size:"small"},model:{value:e.form.workUnit,callback:function(t){e.$set(e.form,"workUnit",t)},expression:"form.workUnit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱：",prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入邮箱",size:"small"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号：",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入手机号",size:"small"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"添加校友信息"===e.title,expression:"title==='添加校友信息'"}],attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submitForm("form")}}},[e._v("确 定")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"添加校友信息"!==e.title,expression:"title!=='添加校友信息'"}],attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.editForm("form")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{staticClass:"set-el-dialog set-course-dialog",attrs:{title:"导入数据",visible:e.dialogVisible,width:"35%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticStyle:{height:"400px"}},[a("div",{staticStyle:{height:"400px","min-width":"280px",width:"50%",float:"left"}},[a("el-steps",{attrs:{direction:"vertical",active:e.active}},[a("el-step",{attrs:{title:"上传文件",icon:"el-icon-upload"}}),e._v(" "),a("el-step",{attrs:{title:"检查数据",icon:e.icon,description:"等待文件上传完毕后自动检查表格数据。"}}),e._v(" "),a("el-step",{attrs:{title:"完成",icon:"el-icon-success"}})],1)],1),e._v(" "),a("div",{staticStyle:{position:"absolute",top:"105px",left:"85px"}},[a("p",{staticStyle:{padding:"10px 0","font-size":"12px"}},[e._v("导入数据前，请先"),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.download}},[e._v("下载模板")]),e._v("，按照模板格式录入数据。")],1),e._v(" "),a("div",{staticClass:"file-upload"},[a("el-upload",{ref:"uploadXls",staticClass:"upload-demo",attrs:{disabled:e.uploadDisabled,action:e.uploadUrl,"on-success":e.handleSuccess,"on-progress":e.onProgress,"on-error":e.onError,limit:1,"show-file-list":!1,accept:".xls,.xlsx",name:"file","on-exceed":e.handleExceed}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleClick}},[a("i",{staticClass:"el-icon-upload el-icon--right"}),e._v("  上传文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持文件格式：.xls .xlsx。")])],1)],1)])])])],1)},staticRenderFns:[]};var n=a("C7Lr")(l,o,!1,function(e){a("ZMFJ")},null,null);t.default=n.exports},ZMFJ:function(e,t){}});
//# sourceMappingURL=83.fa44716336a268479694.js.map