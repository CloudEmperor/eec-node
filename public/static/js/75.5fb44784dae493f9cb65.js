webpackJsonp([75],{"1BZE":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3cXf"),i=a.n(s),l={components:{},data:function(){return{shuntTypeArr:[{code:0,value:"未分流"},{code:1,value:"已分流"}],shuntTypeArr1:[{code:0,value:"未分流"},{code:1,value:"已分流"},{code:"",value:"全部"}],typeval:"",dialogFormVisible:!1,dialogFormVisible1:!1,formLabelWidth:"120px",flag:!1,flag1:!1,addClass:"",currentPage4:1,total:0,page:1,pageSize:15,pageNum:1,form:{academyVal:"",specialtyVal:"",name:"",code:"",grade:"",specialtyId:"",academyId:"",classtype:"",delivery:!1,type:[],resource:"",desc:"",optionsVal:"",optionsVal1:""},formInline:{user:""},rules:{classtype:[{required:!0,message:"请选择班级类型",trigger:"blur"}],academyId:[{required:!0,message:"请选择所属学院",trigger:"blur"}],specialtyId:[{required:!0,message:"请选择所属专业",trigger:"blur"}],name:[{required:!0,message:"请输入班级名称",trigger:"blur"}],code:[{required:!0,message:"请输入班级编号",trigger:"blur"}],grade:[{required:!0,validator:function(e,t,a){/^[0-9]*\d{1,}$/.test(t)?a():a(new Error("年级必输输入数字类型"))},trigger:"blur"}]},tableData:[],loading:!0,optionsarr:[],valuearr:"",optionsarr1:[],valuearr1:"",valuearr2:"",options:[],value:"",options1:[],value1:"",form1:{file:""},file:"",index:1,fileList:[],options2:[],academyName:""}},methods:{successdata:function(e,t){this.dialogFormVisible1=!0,this.teacherssId=t},uploadUrl:function(){var e=localStorage.getItem("x_token");return this.API_URL+"/basic/import/classInformation?x-token="+e},xiazai:function(){location.href=this.API_URL+"/basic/import/template/classInformation"},submitUpload:function(){3===this.index&&(this.classlist(),this.dialogFormVisible1=!1,this.index=1)},handleRemove:function(e,t){this.form1.file=""},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件"),e.size>20480&&this.$message.warning("sorry 上传文件大于20M,请重新上")},closciick:function(e){2===this.index&&(this.index=1),this.dialogFormVisible1=!1},handleSuccess:function(e,t,a){console.log(e),1===e.status?(this.$notify.success({title:"success",message:e.message}),this.index=3):(null==e.data?this.$notify.warning({title:"warning",message:e.message}):this.$notify.warning({title:"warning",message:e.data[0].message}),this.index=2,this.dialogFormVisible1=!0)},handleError:function(e,t,a){this.$notify.error({title:"错误",message:"文件上传失败"})},beforeRemove:function(e,t){3===this.index?this.index=1:2===this.index&&(this.index=1),this.$confirm("确定移除 "+e.name+"？")},shuntType:function(){var e=this;this.$get("system/dict/field/shuntType").then(function(t){e.shuntTypeArr1=JSON.parse(i()(t.data)),e.shuntTypeArr=t.data,e.shuntTypeArr.unshift({code:"",value:"全部"})})},gradesClass:function(){var e=this;this.$get("basic/class/grades").then(function(t){1==t.status&&(e.options2=t.data,e.options6=t.data)})},onSubmit:function(){var e=this,t={shuntType:this.valuearr,academyId:this.valuearr1,specialtyId:this.valuearr2,keywords:this.formInline.user,page:this.pageNum,rows:this.pageSize};this.$post("/basic/class/list",t).then(function(t){1==t.status&&(e.tableData=t.data,e.total=t.total,e.loading=!1)})},classlist:function(){var e=this,t={page:this.pageNum,rows:this.pageSize};this.$post("/basic/class/list",t).then(function(t){1==t.status&&(e.tableData=t.list,e.total=t.total,e.loading=!1)})},handleEdit:function(e,t){var a=this;this.addClass="编辑班级",this.flag1=!0,this.flag=!1,this.dialogFormVisible=!0,this.$get("/basic/specialty/all/"+t.academyId).then(function(e){1==e.status&&(a.options1=e.data)}),this.form.name=t.name,this.form.grade=t.grade,this.form.code=t.code,this.form.id=t.id,this.form.academyId=t.academyId,this.form.specialtyId=t.specialtyId,this.form.classtype=t.shuntType},addcalss:function(){var e=this,t={code:this.form.code,name:this.form.name,grade:this.form.grade,academyId:this.form.academyId,specialtyId:this.form.specialtyId,shuntType:this.form.classtype};this.$post("/basic/class/add",t).then(function(t){1==t.status?(e.$notify({message:"新增成功",type:"success"}),e.tableData.unshift(t.data),e.classlist()):0==t.status&&e.$notify.warning({message:t.message,type:"warning"})})},allxue:function(){var e=this;this.$get("/basic/academy/all?type=1").then(function(t){1==t.status&&(e.options=JSON.parse(i()(t.data)),e.optionsarr=t.data,e.optionsarr.unshift({code:"",name:"全部"}))})},changes:function(){var e=this,t=this.valuearr1;t?this.$get("/basic/specialty/all/"+t).then(function(t){1==t.status&&(e.optionsarr1=t.data,e.optionsarr1.unshift({code:"",name:"全部"}))}):this.optionsarr1=[]},changes1:function(){var e=this,t=this.form.academyId;this.$get("/basic/specialty/all/"+t).then(function(t){1==t.status&&(e.options1=t.data)})},seccons2:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.addcalss(),t.dialogFormVisible=!1,t.classlist()})},resetForm:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1,this.form={}},handleClose:function(){this.dialogFormVisible=!1,this.$refs.form.resetFields(),this.form={}},seccons22:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return console.log("error submit!!"),!1;var s=t.form.name,i=t.form.grade,l=t.form.code,o=t.form.id,n=t.form.academyId,r=t.form.specialtyId,c=t.form.classtype.toString();t.$put("/basic/class/edit",{name:s,grade:i,code:l,id:o,academyId:n,specialtyId:r,shuntType:c}).then(function(a){1==a.status?(t.$notify.success({title:"success",message:"编辑成功"}),t.$refs[e].resetFields(),t.dialogFormVisible=!1,t.onSubmit()):t.$notify.warning({title:"warning",message:a.message})})})},close:function(){this.addClass="添加班级",this.flag=!0,this.flag1=!1,this.dialogFormVisible=!0,this.form={},this.value="",this.value1=""},handleDelete:function(e,t){var a=this;this.$confirm("确定删除该信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$deletes("/basic/class/del/"+t.id).then(function(e){1==e.status?a.onSubmit():0==e.status&&(a.$notify.warning({title:"warning",message:e.message}),a.onSubmit())})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},indexMethod:function(e){return 1*e},handleSizeChange:function(e){this.pageSize=e,this.onSubmit()},handleCurrentChange:function(e){this.pageNum=e,this.onSubmit()}},mounted:function(){this.allxue(),this.classlist(),this.gradesClass()}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"classManagement padding students"},[a("el-dialog",{attrs:{title:e.addClass,visible:e.dialogFormVisible,"before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"班级类型：","label-width":e.formLabelWidth,prop:"classtype"}},[a("el-select",{attrs:{placeholder:"请选择班级类型"},model:{value:e.form.classtype,callback:function(t){e.$set(e.form,"classtype",t)},expression:"form.classtype"}},e._l(e.shuntTypeArr1,function(e){return a("el-option",{key:e.code,attrs:{label:e.value,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属学院：","label-width":e.formLabelWidth,prop:"academyId"}},[a("el-select",{attrs:{placeholder:"请选择所属学院"},on:{change:e.changes1},model:{value:e.form.academyId,callback:function(t){e.$set(e.form,"academyId",t)},expression:"form.academyId"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属专业：","label-width":e.formLabelWidth,prop:"specialtyId"}},[a("el-select",{attrs:{placeholder:"请选择所属专业"},model:{value:e.form.specialtyId,callback:function(t){e.$set(e.form,"specialtyId",t)},expression:"form.specialtyId"}},e._l(e.options1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"班级名称：","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入班级名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"班级编码：","label-width":e.formLabelWidth,prop:"code"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入班级编码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"入学年级：","label-width":e.formLabelWidth,prop:"grade"}},[a("el-select",{attrs:{placeholder:"请选择入学年级"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},e._l(e.options2,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.flag,expression:"flag"}],attrs:{type:"primary"},on:{click:function(t){return e.seccons2("form")}}},[e._v("确 定")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.flag1,expression:"flag1"}],attrs:{type:"primary"},on:{click:function(t){return e.seccons22("form")}}},[e._v("确 定")])],1)],1),e._v(" "),a("form",{attrs:{model:e.form,enctype:"Content-Type: multipart/form-data"}},[a("el-dialog",{attrs:{title:"导入班级信息",visible:e.dialogFormVisible1,"show-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible1=t}}},[a("div",{staticClass:"steps-dv1",staticStyle:{height:"350px"}},[a("el-steps",{attrs:{active:e.index,direction:"vertical"}},[a("el-step",{attrs:{title:"上传文件",icon:"el-icon-edit"}},[a("template",{slot:"description"},[a("div",[e._v("\n                导入班级信息之前，请先“\n                "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请先下载模板",placement:"top-start"}},[a("span",{staticClass:"span-dv",on:{click:e.xiazai}},[e._v("下载模板")])]),e._v("”，按照模板格式录入数据。\n              ")],1)])],2),e._v(" "),a("el-step",{attrs:{title:"检查数据",icon:"el-icon-upload",description:"等待文件上传完毕后自动检查表格数据。"}},[a("template",{slot:"description"},[a("div",[e._v("等待文件上传完毕后自动检查表格数据。")])])],2),e._v(" "),a("el-step",{attrs:{title:"完成",icon:"el-icon-picture"}})],1),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo steps-btn",attrs:{action:e.uploadUrl(),accept:".xls","on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!0,"on-success":e.handleSuccess,"on-error":e.handleError,"before-remove":e.beforeRemove,limit:1,"on-exceed":e.handleExceed}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持文件格式：.xls 类型的文件，且不超过20M")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closciick}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("确 定")])],1)])],1),e._v(" "),a("crumb",{staticStyle:{padding:"0 5px"}},[a("div",{staticClass:"new--btn",attrs:{slot:"right"},on:{click:e.close},slot:"right"},[e._v("+ 新建")]),e._v(" "),a("div",{staticStyle:{float:"left","margin-right":"10px",color:"#03B187",cursor:"pointer"},attrs:{slot:"right",icon:"el-icon-plus"},on:{click:e.successdata},slot:"right"},[a("SvgIcon",{staticStyle:{float:"left",margin:"32px 5px 0 0"},attrs:{"icon-class":"icondaoru",size:"18px"}}),e._v(" 导入")],1)]),e._v(" "),a("div",{staticClass:"classManagement-tab"},[a("div",{staticClass:"classManagement-inp"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("span",{staticClass:"ssss"},[e._v("班级类型：")]),e._v(" "),a("el-select",{staticClass:"pppp",attrs:{placeholder:"请选择"},model:{value:e.valuearr,callback:function(t){e.valuearr=t},expression:"valuearr"}},e._l(e.shuntTypeArr,function(e){return a("el-option",{key:e.code,attrs:{label:e.value,value:e.code}})}),1),e._v(" "),a("span",{staticClass:"sssss"},[e._v("所属学院：")]),e._v(" "),a("el-select",{staticClass:"pppp",attrs:{placeholder:"请选择院校"},on:{change:e.changes},model:{value:e.valuearr1,callback:function(t){e.valuearr1=t},expression:"valuearr1"}},e._l(e.optionsarr,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("span",{staticClass:"sssss"},[e._v("所属专业：")]),e._v(" "),a("el-select",{staticClass:"pppp",attrs:{placeholder:"请先选择院校"},model:{value:e.valuearr2,callback:function(t){e.valuearr2=t},expression:"valuearr2"}},e._l(e.optionsarr1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("span",{staticClass:"sssss"},[e._v("班级搜索：")]),e._v(" "),a("el-input",{staticClass:"pppp",attrs:{placeholder:"班级编码、班级名称、年级"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}}),e._v(" "),a("div",{staticClass:"search--btn",staticStyle:{margin:"6px 0 0 20px"},on:{click:e.onSubmit}},[e._v("搜索")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{label:"班级编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.code))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"班级名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属院校"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.academyVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属专业"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.specialtyVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"年级"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.grade?a("span",[e._v(e._s(t.row.grade)+"级")]):a("span",[e._v(e._s(t.row.grade))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"班级类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(0==t.row.shuntType?"未分流":"已分流"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconbianji1"}}),e._v("  编辑\n            ")],1),e._v(" "),a("el-button",{staticStyle:{color:"#ff5858"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconshanchu"}}),e._v("  删除\n            ")],1)]}}])})],1)],1),e._v(" "),a("div",[[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[15,30,40,50],"page-size":e.pageSize,layout:"prev, pager, next, jumper, sizes, total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]],2)],1)},staticRenderFns:[]};var n=a("C7Lr")(l,o,!1,function(e){a("Uawn")},null,null);t.default=n.exports},Uawn:function(e,t){}});
//# sourceMappingURL=75.5fb44784dae493f9cb65.js.map