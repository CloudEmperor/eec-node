webpackJsonp([126],{QU0A:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("brjS"),i=a("Z+s7"),s={name:"EvaluationCriterion",components:{TitleCurmb:r.a,CourseSteps:i.a},data:function(){var e=this;return{courseName:this.$route.query.title,tableData:[],form:{tableData:[]},rules:{tableData:[{required:!0,validator:function(t,a,r){var i=e.tableData.length,s=0,n=0,o=0;e.tableData.forEach(function(e){0===e.requires.length?s++:n++,e.requires.forEach(function(e){""!==e.basicRequire&&""!==e.excellence&&""!==e.well&&""!==e.qualified&&""!==e.disqualification&&""!==e.ratio&&0!==e.ratio||o++}),0!==s&&r(new Error("请添加考核与评价标准")),n===i&&0===o?r():0!==o&&r(new Error("考核与评价标准内容不能有空"))})},trigger:"blur"}]},api:{details:function(e){return"/basic/course/setExamPattenRequiedView/"+e},save:function(){return"/basic/course/setExamPattenRequied"}}}},created:function(){},mounted:function(){this.initData()},methods:{initData:function(){var e=this,t=this.api.details(this.$route.query.id);this.$get(t).then(function(t){1===t.status?e.tableData=t.data||[]:e.$notify.error({title:"error",duration:1500,message:t.message})})},rowAdd:function(e){this.tableData[e].requires.push({basicRequire:"",excellence:"",well:"",disqualification:"",qualified:"",ratio:0})},rowDel:function(e,t){this.tableData[e].requires.splice(t,1)},formSubmit:function(e,t){var a=this;"save"===t?(this.$refs[e].resetFields(),this.userSave("save")):this.$refs[e].validate(function(e){e&&a.userSave("next")})},userSave:function(e){var t=this,a=this.tableData.map(function(e){return e.requires.forEach(function(t){t.examId||(t.examId=e.examine_id)}),{requireList:e.requires}}),r={id:this.$route.query.id,examineList:a};this.$post(this.api.save(),r).then(function(a){1===a.status?(t.$notify.success({title:"success",duration:1500,message:a.message}),"next"===e?t.$router.push({path:"/Construction/reference",query:{id:t.$route.query.id,title:t.courseName}}):t.initData()):t.$notify.error({title:"error",duration:1500,message:a.message})})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"course-construction"},[a("title-curmb"),e._v(" "),a("course-steps",{attrs:{title:e.courseName,step:5}}),e._v(" "),a("div",{staticClass:"course-construction_body"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"0"}},[a("el-form-item",{attrs:{prop:"tableData"}},e._l(e.tableData,function(t,r){return a("el-row",{key:r},[a("h2",[e._v(e._s("“"+t.examine_name+"”考核与评价标准"))]),e._v(" "),a("el-table",{staticClass:"cc-table",staticStyle:{width:"100%"},attrs:{data:t.requires,border:""}},[a("el-table-column",{attrs:{label:"基本要求"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.basicRequire,callback:function(a){e.$set(t.row,"basicRequire",a)},expression:"scope.row.basicRequire"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"优秀"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.excellence,callback:function(a){e.$set(t.row,"excellence",a)},expression:"scope.row.excellence"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"良好",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.well,callback:function(a){e.$set(t.row,"well",a)},expression:"scope.row.well"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"合格",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.qualified,callback:function(a){e.$set(t.row,"qualified",a)},expression:"scope.row.qualified"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"不合格",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.disqualification,callback:function(a){e.$set(t.row,"disqualification",a)},expression:"scope.row.disqualification"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"成绩比例（%）",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:t.row.ratio,callback:function(a){e.$set(t.row,"ratio",a)},expression:"scope.row.ratio"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("label",{staticClass:"tail-end_del",on:{click:function(a){return e.rowDel(r,t.$index)}}},[a("SvgIcon",{attrs:{"icon-class":"iconqudiao",size:"20px"}})],1)]}}],null,!0)})],1),e._v(" "),a("p",{staticClass:"b-remark"},[e._v(e._s("注：该表格中比例为"+t.examine_name+"成绩比例。"))]),e._v(" "),a("div",{staticClass:"add-step-title add-step-button",on:{click:function(t){return e.rowAdd(r)}}},[a("SvgIcon",{attrs:{"icon-class":"icontianjia",size:"20px"}}),a("span",[e._v("添加基本要求")])],1)],1)}),1),e._v(" "),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:6,offset:9}},[a("el-button",{on:{click:function(t){return e.formSubmit("form","save")}}},[e._v("保  存")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.formSubmit("form","next")}}},[e._v("下一步")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var o=a("C7Lr")(s,n,!1,function(e){a("S2oU")},"data-v-034653bc",null);t.default=o.exports},S2oU:function(e,t){}});
//# sourceMappingURL=126.a8e9d65da33d1bcb84bb.js.map