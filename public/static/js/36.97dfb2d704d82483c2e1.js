webpackJsonp([36],{CZ1i:function(t,e,i){t.exports=i.p+"static/img/img-xuexizhuangtaichaxun.ddf04f5.png"},"Ka+z":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("3cXf"),n=i.n(a),s=i("aA9S"),r=i.n(s),l={name:"StudentLearningStatus",components:{},data:function(){return{name:"",html:"",flag:!0,total:0,detailDialogVisible:!1,signDialogVisible:!1,content:"",loading:!1,tableInfo:[],listQuery:{grade:"",courseId:"",classId:"",search:"",pageNum:1,pageSize:15},pageTitle:"学生学习状态查询",yearOptions:[],curriculumOptions:[],classOptions:[],tableData:[],ids:"",studentId:"",signDetail:{}}},mounted:function(){var t=this;this.loading=!0;var e=localStorage.getItem("versionId");this.$post("/teacher/learningState/gradeList/"+e).then(function(e){1===e.status?t.yearOptions=e.data:t.$notify.error({title:"提示",message:"获取所属学年失败！请刷新重试",duration:2e3}),t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"获取所属学年失败！请刷新重试",duration:2e3}),t.loading=!1}),this.$route.query.listQuery&&(this.listQuery=r()({},JSON.parse(this.$route.query.listQuery)),this.loading=!0,this.$get("teacher/learningState/courseListByGrade",{grade:this.listQuery.grade}).then(function(e){1===e.status?(t.listQuery.courseId="",t.listQuery.classId="",t.curriculumOptions=[],t.classOptions=[],t.curriculumOptions=e.data,t.listQuery=r()({},JSON.parse(t.$route.query.listQuery)),t.loading=!0,t.$get("/teacher/learningState/classesListByGradeAndCourseId",{grade:t.listQuery.grade,courseId:t.listQuery.courseId}).then(function(e){1===e.status?(t.listQuery.classId="",t.classOptions=[],t.classOptions=e.data,t.listQuery=r()({},JSON.parse(t.$route.query.listQuery)),t.getList()):t.$notify.error({title:"提示",message:"获取带课班级失败！请刷新重试",duration:2e3}),t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"获取带课班级失败！请刷新重试",duration:2e3}),t.loading=!1})):t.$notify.error({title:"提示",message:"获取课程名称失败！请刷新重试",duration:2e3}),t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"获取课程名称失败！请刷新重试",duration:2e3}),t.loading=!1}))},methods:{getList:function(){var t=this;this.listQuery.grade?this.listQuery.courseId?(this.flag=!1,this.loading=!0,this.$post("/teacher/learningState/learningStateQuery",this.listQuery).then(function(e){if(1===e.status){t.total=e.data.myPage.rowCount;var i=[];e.data.title.forEach(function(t){i.push({grade:t})}),t.tableInfo=i,t.tableData=e.data.myPage.studentList}else t.$notify.error({title:"提示",message:"获取列表失败,请刷新重试!",duration:2e3});t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"获取列表失败,请刷新重试!",duration:2e3}),t.loading=!1})):this.$notify.warning({title:"提示",message:"请选择课程名称!",duration:2e3}):this.$notify.warning({title:"提示",message:"请选择所属学年!",duration:2e3})},gradeChange:function(){var t=this;this.loading=!0,this.$get("teacher/learningState/courseListByGrade",{grade:this.listQuery.grade}).then(function(e){1===e.status?(t.listQuery.courseId="",t.listQuery.classId="",t.curriculumOptions=[],t.classOptions=[],t.curriculumOptions=e.data):t.$notify.error({title:"提示",message:"获取课程名称失败！请刷新重试",duration:2e3}),t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"获取课程名称失败！请刷新重试",duration:2e3}),t.loading=!1})},courseChange:function(){var t=this;this.loading=!0,this.$get("/teacher/learningState/classesListByGradeAndCourseId",{grade:this.listQuery.grade,courseId:this.listQuery.courseId}).then(function(e){1===e.status?(t.listQuery.classId="",t.classOptions=[],t.classOptions=e.data):t.$notify.error({title:"提示",message:"获取带课班级失败！请刷新重试",duration:2e3}),t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"获取带课班级失败！请刷新重试",duration:2e3}),t.loading=!1})},headInfo:function(t){this.pageTitle=t[1]},search:function(){this.getList()},handleSizeChange:function(t){this.listQuery.pageSize=t,this.getList()},handleCurrentChange:function(t){this.listQuery.pageNum=t,this.getList()},handleSelectionChange:function(t){var e=[];t.forEach(function(t,i){e.push(t.id)}),this.ids=e.join(",")},viewDetail:function(t){var e=this,i=this.curriculumOptions.find(function(t){if(t.id===e.listQuery.courseId)return t});this.$router.push({name:"statusInfo",query:{info:n()(t),course:n()(i),tableInfo:n()(this.tableInfo),listQuery:n()(this.listQuery)}})},sign:function(t){this.signDetail=t,this.signDialogVisible=!0,this.studentId=t.id,this.content=""},cancelSign:function(t){var e=this;this.$confirm("是否取消重点标记?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){e.$get("/teacher/learningState/deleteKeyMark",{markId:t.markId}).then(function(t){1===t.status?(e.$notify.success({title:"提示",message:"已取消重点标记!",duration:2e3}),e.getList()):e.$notify.error({title:"提示",message:"取消重点标记失败！请稍后重试",duration:2e3})}).catch(function(t){e.$notify.error({title:"提示",message:"取消重点标记失败！请稍后重试",duration:2e3})})}).catch(function(){})},handleSubmuit:function(){var t=this;""===this.content.trim()?this.$notify.warning({title:"提示",message:"请添加备注!",duration:2e3}):(this.loading=!0,this.$post("/teacher/learningState/keyMark",{studentId:this.signDetail.id,courseId:this.listQuery.courseId,comment:this.content}).then(function(e){1===e.status?(t.$notify.success({title:"提示",message:"重点标记成功!",duration:2e3}),t.signDialogVisible=!1,t.getList()):t.$notify.error({title:"提示",message:"重点标记失败！请重试",duration:2e3}),t.loading=!1}).catch(function(e){t.$notify.error({title:"提示",message:"重点标记失败！请重试",duration:2e3}),t.loading=!1}))},exportList:function(){if(this.listQuery.grade)if(this.listQuery.courseId){var t=JSON.parse(n()(this.listQuery));delete t.pageNum,delete t.pageSize;var e="?";for(var i in t)e+=i+"="+t[i]+"&";e=e.slice(0,-1),window.location.href=this.API_URL+"/teacher/learningState/export"+e}else this.$notify.warning({title:"提示",message:"请选择课程名称!",duration:2e3});else this.$notify.warning({title:"提示",message:"请选择所属学年!",duration:2e3})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:t.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"center studentLearningStatus"},[a("div",{staticClass:"center_breadcrumb"},[a("Crumb")],1),t._v(" "),a("div",{staticClass:"center_content"},[a("div",{staticClass:"center_content_search",staticStyle:{"margin-bottom":"0","border-radius":"10px 10px 0 0"}},[a("div",{staticStyle:{"margin-bottom":"60px","font-size":"24px","font-family":"PingFang SC","font-weight":"bold",color:"rgba(255,255,255,1)","text-align":"center",position:"relative"}},[t._v("请先按条件查询您所要查询的学年、课程及所带班级\n        "),a("div",{staticStyle:{width:"120px",height:"28px",border:"1px solid rgba(176,249,224,1)","border-radius":"14px","font-size":"14px","line-height":"28px",float:"right",cursor:"pointer",position:"absolute",top:"0",right:"0"},on:{click:t.exportList}},[a("SvgIcon",{attrs:{"icon-class":"icondaochu-excel"}}),t._v("  导出Excel")],1)]),t._v(" "),a("el-form",{ref:"listQuery",attrs:{model:t.listQuery,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"所属学年:"}},[a("el-select",{attrs:{placeholder:"请选择所属学年"},on:{change:t.gradeChange},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.listQuery.grade,callback:function(e){t.$set(t.listQuery,"grade",e)},expression:"listQuery.grade"}},t._l(t.yearOptions,function(t){return a("el-option",{key:t.grade,attrs:{label:t.grade+" - "+(t.grade+1)+"学年",value:t.grade}})}),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"课程名称:"}},[a("el-select",{attrs:{placeholder:"请先选择课程"},on:{change:t.courseChange},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.listQuery.courseId,callback:function(e){t.$set(t.listQuery,"courseId",e)},expression:"listQuery.courseId"}},t._l(t.curriculumOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"带课班级:"}},[a("el-select",{attrs:{placeholder:"请先选择所属学年和课程名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.listQuery.classId,callback:function(e){t.$set(t.listQuery,"classId",e)},expression:"listQuery.classId"}},t._l(t.classOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"搜索:"}},[a("el-input",{staticClass:"search",attrs:{placeholder:"学号 姓名",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.listQuery.search,callback:function(e){t.$set(t.listQuery,"search",e)},expression:"listQuery.search"}})],1)],1)],1),t._v(" "),a("el-row",{staticStyle:{"margin-top":"20px"}},[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{width:"270px",height:"50px",background:"#fff","border-radius":"25px","text-align":"center",color:"#03B187","line-height":"50px",margin:"0 auto","font-weight":"bold","font-size":"18px",cursor:"pointer"},on:{click:t.search}},[t._v("查  询")])])],1)],1)],1),t._v(" "),a("div",{staticClass:"table-container",staticStyle:{"border-radius":"0 0 10px 10px"}},[t.flag?a("div",{staticStyle:{"text-align":"center",padding:"50px 0 150px"}},[a("img",{staticStyle:{width:"500px"},attrs:{src:i("CZ1i"),alt:""}}),t._v(" "),a("p",{staticStyle:{"font-size":"20px","font-family":"PingFang SC","font-weight":"bold",color:"rgba(3,177,135,1)","margin-top":"49px"}},[t._v("选择学年、课程、班级查看学生的学习状态")])]):a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"code",label:"学号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"className",label:"所属班级"}}),t._v(" "),t._l(t.tableInfo,function(e,i){return a("el-table-column",{key:i,attrs:{label:e.grade},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n              "+t._s(0==e.row["targetVal"+(i+1)]?"未开始此能力的学习":e.row["val"+(i+1)]>=e.row["targetVal"+(i+1)]?"达到预期值":"未达到预期值")+"\n            ")])]}}],null,!0)})}),t._v(" "),a("el-table-column",{attrs:{label:"标记备注"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.comment?[a("div",[a("SvgIcon",{attrs:{"icon-class":"iconbiaoji"}}),t._v("  "+t._s(e.row.comment)+"\n            ")],1)]:void 0}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"operate-button distance"},[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.viewDetail(e.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconxuexizhuangtaixiangqing"}}),t._v("  查看详情\n              ")],1)],1),t._v(" "),0==e.row.mark?a("div",{staticClass:"operate-button distance"},[a("el-button",{staticStyle:{width:"68.55px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.sign(e.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconbiaoji-kong"}})],1)],1):1==e.row.mark?a("div",{staticClass:"operate-button distance"},[a("el-button",{staticStyle:{width:"68.55px"},attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.cancelSign(e.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconbiaoji"}})],1)],1):t._e()]}}])})],2),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.flag,expression:"!flag"}],staticClass:"center_pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.pageNum,"page-sizes":[15,30,40,50],"page-size":t.listQuery.pageSize,layout:"prev, pager, next, jumper, sizes, total",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"学习状态分析详情",visible:t.detailDialogVisible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.detailDialogVisible=e}}},[a("div",{staticStyle:{"font-size":"16px","margin-bottom":"20px"}},[a("span",{staticStyle:{"font-weight":"700"}},[t._v("学生姓名： ")]),t._v(t._s(t.name))]),t._v(" "),a("div",{staticStyle:{"font-size":"16px"}},[a("div",{staticStyle:{"font-weight":"700","margin-bottom":"10px"}},[t._v("学习状态： ")]),t._v(" "),a("div",{staticClass:"detailBox",staticStyle:{"line-height":"30px","font-size":"14px","text-indent":"2em"},domProps:{innerHTML:t._s(t.html)}})]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.detailDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.detailDialogVisible=!1}}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"添加标记备注",visible:t.signDialogVisible,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.signDialogVisible=e}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("添加备注：")]),t._v(" "),a("el-input",{attrs:{type:"textarea",rows:10,resize:"none",placeholder:"备注信息不超过150字",maxlength:"150"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.signDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleSubmuit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=i("C7Lr")(l,o,!1,function(t){i("ZmUA")},null,null);e.default=c.exports},ZmUA:function(t,e){}});
//# sourceMappingURL=36.97dfb2d704d82483c2e1.js.map