webpackJsonp([8],{CyXQ:function(e,t,s){e.exports=s.p+"static/img/haveafinish.1e441dc.png"},EAZI:function(e,t,s){"use strict";var i=s("3cXf"),a=s.n(i),n={name:"AnswerPc",components:{MyRate:s("eBgv").a},props:{id:{type:String,default:""},type:{type:String,default:"inside"}},data:function(){return{formData:{formTitle:"",remarks:"",endWord:""},list:[],isSubmit:!1,inputFileIndex:null,form:{formId:"",createUser:"",data:"",ip:""},api:{uploadUrl:this.API_URL+"/system/file/editorUpload?x-token="+localStorage.getItem("x_token"),queryQuestionAll:"/form/rest/FormQuestionBaseBusiness/queryQuestionAll/v1",save:"/form/rest/FormAnserBusiness/save/v1"}}},created:function(){this.initData()},mounted:function(){},methods:{initData:function(){var e=this,t={formId:this.id};this.$post(this.api.queryQuestionAll,t).then(function(t){if(200===t.code){var s=0;e.formData=t.data.form;var i=t.data.questions||[];i.forEach(function(e,t){"gradeCheckbox"===e.type||"matrixGauge"===e.type?e.questionValue=[]:e.questionValue="","splitLine"===e.type||"baseRemark"===e.type?e.sort=null:(s+=1,e.sort=s)}),e.list=i}})},deleteFile:function(e){this.list[e].questionValue=""},chooseFile:function(e){this.inputFileIndex=e,this.$refs.inputFile[0].click()},uploadChange:function(){var e=this,t=this.$refs.inputFile[0].files[0];if(t.size>31457280)this.$notify.error({title:"error",duration:1500,message:"请选择30M以内文件"});else{var s=new window.FormData;s.append("file",t),this.$post(this.api.uploadUrl,s).then(function(s){0===s.success?(e.list[e.inputFileIndex].desc=t.name,e.list[e.inputFileIndex].questionValue=s.id):e.$notify.error({title:"error",duration:1500,message:"上传失败，请重新上传"})})}},myRateChange:function(e,t,s){null===s?this.list[t].questionValue=e:this.list[t].rowDesc[s].questionValue=e},submit:function(){if(this.isSubmit)this.$message({message:"请勿重复提交!",type:"warning"});else if(this.validateRequired(this.list)){var e=[];JSON.parse(a()(this.list)).forEach(function(t){if("baseRemark"!==t.type&&"splitLine"!==t.type){var s=null;if("gradeCheckbox"===t.type)s=t.questionValue;else if("matrixGauge"===t.type){var i=[];t.rowDesc.forEach(function(e){e.questionValue&&i.push(e.questionValue)}),s=i}else s=t.questionValue;e.push({questionId:t.id,questionValue:s})}}),this.form.formId=this.id,this.form.data=a()(e),this.form.ip=localStorage.getItem("Ip"),this.saveFn()}},saveFn:function(){var e=this;this.isSubmit=!0,this.$post(this.api.save,this.form).then(function(t){200===t.code?(e.$notify.success({title:"success",duration:1500,message:"提交成功"}),"inside"===e.type&&e.$emit("onSuccess",!0)):(e.isSubmit=!1,e.$notify.error({title:"error",duration:1500,message:t.msg}))}).catch(function(t){e.isSubmit=!1})},validateRequired:function(e){for(var t=this,s=!1,i=function(i){if("baseRemark"!==e[i].type&&"splitLine"!==e[i].type&&e[i].required){var a=function(t){return e[i].sort+". "+e[i].title+" "+t};if(!("gradeRadio"!==e[i].type&&"sex"!==e[i].type||e[i].questionValue))return t.$message.error(a("是必选项，请选择选项")),s=!1,"break";if("gradeCheckbox"===e[i].type&&0===e[i].questionValue.length)return t.$message.error(a("是必选项，请选择选项")),s=!1,"break";if("baseGauge"===e[i].type&&""===e[i].questionValue)return t.$message.error(a("是必选项，请为选项打分")),s=!1,"break";if("matrixGauge"===e[i].type){var n=0;if(e[i].rowDesc.forEach(function(e){e.questionValue&&n++}),n!==e[i].rowDesc.length)return t.$message.error(a("是必选项，请为所有选项打分")),s=!1,"break";s=!0}else if("phone"===e[i].type){if(!e[i].questionValue)return t.$message.error(a("是必填项，请输入内容")),s=!1,"break";if(!/^[1][3,4,5,7,8][0-9]{9}$/.test(e[i].questionValue))return t.$message.error(a("请输入正确的手机号码")),s=!1,"break";s=!0}else if("email"===e[i].type){if(!e[i].questionValue)return t.$message.error(a("是必填项，请输入内容")),s=!1,"break";if(!/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(e[i].questionValue))return t.$message.error(a("请输入正确的邮箱地址")),s=!1,"break";s=!0}else{if(!e[i].questionValue)return t.$message.error(a("是必填项，请输入内容")),s=!1,"break";s=!0}}},a=0;a<e.length;a++){if("break"===i(a))break}return s}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"t"},[s("div",{staticClass:"t_container"},[s("div",{staticClass:"t_content"},[s("div",{staticClass:"t_content_head"},[s("div",{staticClass:"t-title mtop"},[s("p",{domProps:{innerHTML:e._s(e.formData.formTitle)}})]),e._v(" "),s("div",{staticClass:"t-intro mtop"},[e._v(e._s(e.formData.remarks))]),e._v(" "),s("div",{staticClass:"t-hr mtop"})]),e._v(" "),s("div",{staticClass:"t_content_body"},e._l(e.list,function(t,i){return s("div",{key:i,staticClass:"t-ques maxtop"},["baseRemark"===t.type?s("div",{staticClass:"t-ques_title",class:{" t-required":t.required}},[e._v(" "+e._s(t.title)+" ")]):e._e(),e._v(" "),"splitLine"!==t.type&&"baseRemark"!==t.type?s("div",{staticClass:"t-ques_title",class:{" t-required":t.required}},[s("span",{staticClass:"qnum"},[e._v(e._s(t.sort)+".")]),s("span",[e._v(e._s(t.title))])]):e._e(),e._v(" "),"splitLine"===t.type?s("div",{staticClass:"line"}):e._e(),e._v(" "),s("div",{staticClass:"t-ques_matrix"},["gradeRadio"===t.type||"sex"===t.type?s("div",{staticClass:"t-checkbox"},[s("el-radio-group",{staticClass:"radio-box",model:{value:t.questionValue,callback:function(s){e.$set(t,"questionValue",s)},expression:"vo.questionValue"}},e._l(t.items,function(t,i){return s("el-radio",{key:i,attrs:{label:t.text}},[e._v(e._s(t.text))])}),1)],1):e._e(),e._v(" "),"gradeCheckbox"===t.type?s("div",{staticClass:"t-checkbox"},[s("el-checkbox-group",{staticClass:"checkbox-box",model:{value:t.questionValue,callback:function(s){e.$set(t,"questionValue",s)},expression:"vo.questionValue"}},e._l(t.items,function(e,t){return s("el-checkbox",{key:t,attrs:{label:e.text}})}),1)],1):e._e(),e._v(" "),"baseText"===t.type||"name"===t.type||"phone"===t.type||"email"===t.type||"academy"===t.type||"specialty"===t.type||"industry"===t.type||"profession"===t.type?s("div",{staticClass:"t-checkbox"},[s("el-input",{staticClass:"t-input",model:{value:t.questionValue,callback:function(s){e.$set(t,"questionValue",s)},expression:"vo.questionValue"}})],1):e._e(),e._v(" "),"baseTextArea"===t.type?s("div",{staticClass:"t-checkbox"},[s("el-input",{staticClass:"t-input",attrs:{type:"textarea",rows:2},model:{value:t.questionValue,callback:function(s){e.$set(t,"questionValue",s)},expression:"vo.questionValue"}})],1):e._e(),e._v(" "),"baseGauge"===t.type?s("div",{staticClass:"t-checkbox"},[s("div",{staticClass:"radio-box-row"},[s("my-rate",{attrs:{total:t.itemNum,parentIndex:i},on:{change:e.myRateChange}})],1),e._v(" "),s("p",{staticClass:"tip",class:{tip_five:5===t.itemNum}},[s("span",[e._v(e._s(t.startDesc))]),s("span",[e._v(e._s(t.endDesc))])])]):e._e(),e._v(" "),"uploadFile"===t.type?s("div",{staticClass:"t-checkbox q_file_upload"},[s("input",{ref:"inputFile",refInFor:!0,staticStyle:{display:"none"},attrs:{type:"file",name:"file"},on:{change:e.uploadChange}}),e._v(" "),t.questionValue?s("div",{staticClass:"q_file_upload_img"},[s("label",[e._v(e._s(t.desc))]),e._v(" "),s("div",{staticClass:"df"},[s("label",{on:{click:function(t){return e.chooseFile(i)}}},[e._v("重新选择  ")]),e._v("|\n                                   "),s("span",{on:{click:function(t){return e.deleteFile(i)}}},[e._v("  删除")])])]):s("div",{staticClass:"q_file_upload_up",on:{click:function(t){return e.chooseFile(i)}}},[e._m(0,!0)])]):e._e(),e._v(" "),"matrixGauge"===t.type?s("div",{staticClass:"t-checkbox"},[s("table",{staticClass:"q_table"},[s("tbody",[s("tr",{staticClass:"q_table_head"},[s("td",{staticClass:"row_td"}),e._v(" "),s("td",{staticClass:"row_content",staticStyle:{"text-align":"left"}},[s("p",e._l(t.itemNum,function(i,a){return s("span",{key:a,staticClass:"t_span"},[e._v(e._s(0===a?"非常不满意":a===t.itemNum-1?"非常满意":""))])}),0),e._v(" "),s("p",e._l(t.itemNum,function(t,i){return s("label",{key:i},[e._v(e._s(i+1))])}),0)])]),e._v(" "),e._l(t.rowDesc,function(a,n){return s("tr",{key:n},[s("td",{staticClass:"row_td",staticStyle:{"text-align":"left"}},[e._v(e._s(a.text)+" ")]),e._v(" "),s("td",{staticClass:"row_content"},[s("my-rate",{attrs:{total:t.itemNum,isText:!1,parentIndex:i,childIndex:n},on:{change:e.myRateChange}})],1)])})],2)])]):e._e()])])}),0),e._v(" "),s("div",{staticClass:"end_remarks"},[e._v(e._s(e.formData.endWord))]),e._v(" "),s("div",{staticClass:"t_footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"m_upload_btn"},[t("i",{staticClass:"el-icon-upload"}),t("label",[this._v("  选择文件（30M以内）")])])}]};var o=s("C7Lr")(n,r,!1,function(e){s("rMRS")},null,null);t.a=o.exports},Rrug:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"Answer",components:{AnswerPc:s("EAZI").a},data:function(){return{id:this.$route.query.id||"",userId:this.$route.query.userId||"",userDialogFormVisible:!1}},methods:{onSuccessFn:function(){this.userDialogFormVisible=!0},create:function(){this.$router.push({path:"/Iaminvolved/result",query:{formId:this.id,userId:this.userId,origin:"answer"}})},handleDialogClose:function(){window.history.back(-1)}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"answer"},[i("answer-pc",{attrs:{id:e.id},on:{onSuccess:e.onSuccessFn}}),e._v(" "),i("el-dialog",{staticClass:"accomplish-dialog",attrs:{title:"问卷详情",visible:e.userDialogFormVisible,"before-close":e.handleDialogClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.userDialogFormVisible=t}}},[i("div",{staticClass:"accomplish"},[i("img",{attrs:{src:s("CyXQ")}}),e._v(" "),i("p",[e._v("已完成问卷填写，可预览当前问卷")])]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleDialogClose}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("预 览")])],1)])],1)},staticRenderFns:[]};var n=s("C7Lr")(i,a,!1,function(e){s("wuKE")},null,null);t.default=n.exports},rMRS:function(e,t){},wuKE:function(e,t){}});
//# sourceMappingURL=8.d496b2dce14c2c6dcc4a.js.map