webpackJsonp([96],{WzVU:function(e,t){},emAB:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("3cXf"),a=r.n(o),s=r("brjS"),n=r("Z+s7"),i={name:"BasicRequirements",components:{TitleCurmb:s.a,CourseSteps:n.a},data:function(){var e=this;return{courseName:this.$route.query.title,programObjective:[],tableData:[],tableDataDelArr:[],form:{tableData:[]},rules:{tableData:[{required:!0,validator:function(t,r,o){var a=0;0===e.tableData.length&&o(new Error("请添加课程目标")),e.tableData.forEach(function(e){""!==e.courseContent&&""!==e.courseRequirment&&""!==e.period&&0!==e.period&&""!==e.courseMode&&0!==e.checkedObjective.length||a++}),0===a?o():o(new Error("教学内容与基本要求信息不能有空"))},trigger:"blur"}]},api:{details:function(e){return"/basic/course/setContentView/"+e},getId:function(){return"/basic/courseGoal/getId"},courseGoal:function(e){return"/basic/courseGoal/course/"+e},save:function(){return"/basic/course/setContent"}}}},created:function(){},mounted:function(){this.getCourseGoal(),this.initData()},methods:{initData:function(){var e=this,t=this.api.details(this.$route.query.id);this.$get(t).then(function(t){if(1===t.status){var r=t.data||[];r.forEach(function(e){e.changed=1,e.checkedObjective=[],e.contentGolds.forEach(function(t){e.checkedObjective.push(t.courseGoalId)})}),e.tableData=r}else e.$notify.error({title:"error",duration:1500,message:t.message})})},getCourseGoal:function(){var e=this,t=this.api.courseGoal(this.$route.query.id);this.$get(t).then(function(t){1===t.status?e.programObjective=t.data:e.$notify.error({title:"error",duration:1500,message:t.message})})},addProgramObjective:function(){var e=this;this.$get(this.api.getId()).then(function(t){var r={courseContent:"",courseRequirment:"",period:"",courseMode:"",checkedObjective:[],changed:0,courseId:e.$route.query.id,id:t};e.tableData.push(r)})},basicDel:function(e,t){1===e.changed&&(e.changed=2,this.tableDataDelArr.push(e)),this.tableData.splice(t,1)},formSubmit:function(e,t){var r=this;"save"===t?(this.$refs[e].resetFields(),this.userSave("save")):this.$refs[e].validate(function(e){e&&r.userSave("next")})},userSave:function(e){var t=this,r=JSON.parse(a()(this.tableData)).concat(this.tableDataDelArr).map(function(e){var t={courseId:e.courseId,courseContent:e.courseContent,courseRequirment:e.courseRequirment,period:e.period,id:e.id,courseMode:e.courseMode,changed:e.changed,contentGolds:[]};return e.contentGolds=[],e.checkedObjective.forEach(function(r){t.contentGolds.push({courseContentId:e.id,courseGoalId:r})}),t}),o={id:this.$route.query.id,courseContents:r};this.$post(this.api.save(),o).then(function(r){1===r.status?(t.$notify.success({title:"success",duration:1500,message:r.message}),"next"===e?t.$router.push({path:"/Construction/appraisalMethod",query:{id:t.$route.query.id,title:t.courseName}}):t.initData()):t.$notify.error({title:"error",duration:1500,message:r.message})})}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"course-construction"},[r("title-curmb"),e._v(" "),r("course-steps",{attrs:{title:e.courseName,step:3}}),e._v(" "),r("div",{staticClass:"course-construction_body"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"0"}},[r("h2",[e._v("教学内容与基本要求")]),e._v(" "),r("el-row",[r("el-form-item",{attrs:{prop:"tableData"}},[r("el-table",{staticClass:"cc-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{label:"教学内容（知识点）"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.courseContent,callback:function(r){e.$set(t.row,"courseContent",r)},expression:"scope.row.courseContent"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"教学要求"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{type:"textarea",rows:1},model:{value:t.row.courseRequirment,callback:function(r){e.$set(t.row,"courseRequirment",r)},expression:"scope.row.courseRequirment"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"学时",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:t.row.period,callback:function(r){e.$set(t.row,"period",r)},expression:"scope.row.period"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"教学方式",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{model:{value:t.row.courseMode,callback:function(r){e.$set(t.row,"courseMode",r)},expression:"scope.row.courseMode"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"课程目标",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{staticClass:"tail-end-input",attrs:{filterable:"",multiple:"",placeholder:"请选择"},model:{value:t.row.checkedObjective,callback:function(r){e.$set(t.row,"checkedObjective",r)},expression:"scope.row.checkedObjective"}},e._l(e.programObjective,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("label",{staticClass:"tail-end_del",on:{click:function(r){return e.basicDel(t.row,t.$index)}}},[r("SvgIcon",{attrs:{"icon-class":"iconqudiao",size:"20px"}})],1)]}}])})],1)],1),e._v(" "),r("p",{staticClass:"b-remark"},[e._v("备注：①教学内容为对应支撑课程教学目标指标点的教学内容（知识点）；②教学要求为针对课程教学目标提出的具体要求；③教学方式包括面授和线上，其中面授包括：讲授、实验、讨论。")]),e._v(" "),r("div",{staticClass:"add-step-title add-step-button",on:{click:e.addProgramObjective}},[r("SvgIcon",{attrs:{"icon-class":"icontianjia",size:"20px"}}),r("span",[e._v("添加教学内容与基本要求")])],1)],1),e._v(" "),r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:6,offset:9}},[r("div",{staticClass:"c-footer"},[r("el-button",{on:{click:function(t){return e.formSubmit("form","save")}}},[e._v("保  存")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.formSubmit("form","next")}}},[e._v("下一步")])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var u=r("C7Lr")(i,c,!1,function(e){r("WzVU")},"data-v-3205c114",null);t.default=u.exports}});
//# sourceMappingURL=96.d2c8b4a97a8fbcf260ae.js.map