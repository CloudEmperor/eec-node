webpackJsonp([89],{"2Fke":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),s=a.n(i),l=a("a3Yh"),o=a.n(l),n={components:{},data:function(){var e;return e={dialogFormVisible:!1,dialogFormVisible1:!1,formLabelWidth:"140px",flag:!1,flag1:!1,addClass:"",currentPage4:1,total:0,page:1,pageSize:15,pageNum:1,form:{academyVal:"",specialtyVal:"",name:"",code:"",grade:"",specialtyId:"",academyId:"",delivery:!1,type:[],resource:"",desc:"",workNumber:"",genderVal:"",gender:"",education:"",optionsVal:"",optionsVal1:"",email:"",phone:"",degree:"",political:"",ethnicity:""},formInline:{user:""},rules:{ethnicity:[{required:!0,message:"请选择名族",trigger:"blur"}],academyId:[{required:!0,message:"请选择所属学院",trigger:"blur"}],political:[{required:!0,message:"请选择政治面貌",trigger:"blur"}],education:[{required:!0,message:"请选择学历",trigger:"blur"}],degree:[{required:!0,message:"请选择学位",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"blur"}],workNumber:[{required:!0,message:"请输入教职工工号",trigger:"blur"}],name:[{required:!0,message:"请输入教职工姓名",trigger:"blur"}],grade:[{validator:function(e,t,a){/^[0-9]*$/.test(t)?a():a(new Error("学号必须是由4-9位数字和字母组合"))},trigger:"blur",required:!0}],phone:[{validator:function(e,t,a){""==t||void 0==t?a():/[0-9]{11}/.test(t)?a():a(new Error("请输入正确的手机号格式"))},trigger:"blur"}],email:[{validator:function(e,t,a){""==t||void 0==t?a():/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(t)?a():a(new Error("请输入正确的邮箱格式"))},trigger:"blur"}]},tableData:[],loading:!0,optionsarr:[],valuearr:"",optionsarr1:[],valuearr1:"",options:[],value:"",options1:[],value1:""},o()(e,"form",{file:""}),o()(e,"file",""),o()(e,"index",1),o()(e,"fileList",[]),o()(e,"options4",[{code:0,value:"男"},{code:1,value:"女"}]),o()(e,"value4",""),o()(e,"options5",""),o()(e,"value5",""),o()(e,"options6",[]),o()(e,"value6",""),o()(e,"options2",[]),o()(e,"value2",""),o()(e,"options3",[]),o()(e,"value3",""),e},methods:{successdata:function(e,t){this.dialogFormVisible1=!0,this.teacherssId=t},uploadUrl:function(){var e=localStorage.getItem("x_token");return this.API_URL+"/basic/import/teacher?x-token="+e},xiazai:function(){location.href=this.API_URL+"/basic/import/template/teacher"},submitUpload:function(){3===this.index&&(this.onSubmit(),this.dialogFormVisible1=!1,this.index=1)},handleRemove:function(e,t){this.form.file=""},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件"),e.size>20480&&this.$message.warning("sorry 上传文件大于20M,请重新上")},closciick:function(e){2===this.index&&(this.index=1),this.dialogFormVisible1=!1},handleSuccess:function(e,t,a){1===e.status?(this.$notify.success({title:"success",message:e.message}),this.index=3):(null==e.data?this.$notify.warning({title:"warning",message:e.message}):this.$notify.warning({title:"warning",message:e.data[0].message}),this.index=2,this.dialogFormVisible1=!0)},handleError:function(e,t,a){this.$notify.error({title:"错误",message:"文件上传失败"})},beforeRemove:function(e,t){3===this.index?this.index=1:2===this.index&&(this.index=1),this.$confirm("确定移除 "+e.name+"？")},fielddegree:function(){var e=this;this.$get("/system/dict/field/degree").then(function(t){1==t.status&&(e.options3=t.data)})},ethnicitydata:function(){var e=this;this.$get("/system/dict/field/ethnicity").then(function(t){1==t.status&&(e.options5=t.data)})},education:function(){var e=this;this.$get("/system/dict/field/education").then(function(t){1==t.status&&(e.options2=t.data)})},political:function(){var e=this;this.$get("/system/dict/field/political").then(function(t){1==t.status&&(e.options6=t.data)})},onSubmit:function(){var e=this,t={academyId:this.valuearr,keywords:this.formInline.user,rows:this.pageSize,page:this.pageNum};this.$post("/basic/teacher/list",t).then(function(t){1==t.status&&(e.tableData=t.data,e.loading=!1,e.total=t.total)})},handleEdit:function(e,t){this.addClass="编辑教师",this.dialogFormVisible=!0,this.flag1=!0,this.flag=!1,this.form=JSON.parse(s()(t))},addteacher:function(){var e=this;this.$post("/basic/teacher/add",this.form).then(function(t){1==t.status?(e.$message({message:"新增成功",type:"success"}),e.tableData.unshift(t.data),e.onSubmit(),e.allxue()):e.$message({message:t.message,type:"warning"})})},allxue:function(){var e=this;this.$get("/basic/academy/all?type=0").then(function(t){1==t.status&&(e.options=JSON.parse(s()(t.data)),e.optionsarr=t.data,e.optionsarr.unshift({id:"",name:"全部"}))})},allxue1:function(){var e=this;this.$get("/basic/academy/all?type=0").then(function(t){1==t.status&&(e.options=JSON.parse(s()(t.data)))})},changes:function(){},changes1:function(){var e=this,t=this.value;this.$get("/basic/specialty/all/"+t).then(function(t){1==t.status&&(e.options1=t.data)})},seccons2:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.dialogFormVisible=!1,t.addteacher(),t.allxue1()})},resetForm:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1,this.form={}},handleClose:function(){this.dialogFormVisible=!1,this.$refs.form.resetFields(),this.form={}},seccons22:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return console.log("error submit!!"),!1;t.$put("/basic/teacher/edit",t.form).then(function(a){1==a.status?(t.$notify.success({title:"success",message:"编辑成功"}),t.$refs[e].resetFields(),t.dialogFormVisible=!1):0==a.status&&t.$notify.warning({title:"warning",message:a.message}),t.onSubmit()}),t.allxue1()})},close:function(){this.addClass="添加教师",this.flag=!0,this.flag1=!1,this.dialogFormVisible=!0,this.form={},this.allxue1(),this.value="",this.value1=""},handleDelete:function(e,t){var a=this;this.$confirm("确定删除该信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$deletes("/basic/teacher/del/"+t.id).then(function(e){1==e.status?a.onSubmit():0==e.status&&a.$notify.warning({title:"warning",message:e.message})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},indexMethod:function(e){return 1*e},handleSizeChange:function(e){this.pageSize=e,this.onSubmit()},handleCurrentChange:function(e){this.pageNum=e,this.onSubmit()}},mounted:function(){this.allxue(),this.onSubmit(),this.political(),this.ethnicitydata(),this.fielddegree(),this.education()}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"classManagement padding students"},[a("el-dialog",{attrs:{title:e.addClass,visible:e.dialogFormVisible,"before-close":e.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"教职工工号：","label-width":e.formLabelWidth,prop:"workNumber"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入教职工号"},model:{value:e.form.workNumber,callback:function(t){e.$set(e.form,"workNumber",t)},expression:"form.workNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"教职工姓名：","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入教职工姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属学院/部门：","label-width":e.formLabelWidth,prop:"academyId"}},[a("el-select",{attrs:{placeholder:"请选择所属学院"},on:{change:e.changes1},model:{value:e.form.academyId,callback:function(t){e.$set(e.form,"academyId",t)},expression:"form.academyId"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"性别：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},e._l(e.options4,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"民族：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择民族"},model:{value:e.form.ethnicity,callback:function(t){e.$set(e.form,"ethnicity",t)},expression:"form.ethnicity"}},e._l(e.options5,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"政治面貌：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择政治面貌"},model:{value:e.form.political,callback:function(t){e.$set(e.form,"political",t)},expression:"form.political"}},e._l(e.options6,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学历：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择学历"},model:{value:e.form.education,callback:function(t){e.$set(e.form,"education",t)},expression:"form.education"}},e._l(e.options2,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学位：","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择学位"},model:{value:e.form.degree,callback:function(t){e.$set(e.form,"degree",t)},expression:"form.degree"}},e._l(e.options3,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱：","label-width":e.formLabelWidth,prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号：","label-width":e.formLabelWidth,prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入手机号"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.flag,expression:"flag"}],attrs:{type:"primary"},on:{click:function(t){return e.seccons2("form")}}},[e._v("确 定")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.flag1,expression:"flag1"}],attrs:{type:"primary"},on:{click:function(t){return e.seccons22("form")}}},[e._v("确 定")])],1)],1),e._v(" "),a("form",{attrs:{model:e.form,enctype:"Content-Type: multipart/form-data"}},[a("el-dialog",{attrs:{title:"导入教职工信息",visible:e.dialogFormVisible1,"show-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible1=t}}},[a("div",{staticClass:"steps-dv1",staticStyle:{height:"350px"}},[a("el-steps",{attrs:{active:e.index,direction:"vertical"}},[a("el-step",{attrs:{title:"上传文件",icon:"el-icon-edit"}},[a("template",{slot:"description"},[a("div",[e._v("\n                导入教职工信息之前，请先“\n                "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请先下载模板",placement:"top-start"}},[a("span",{staticClass:"span-dv",on:{click:e.xiazai}},[e._v("下载模板")])]),e._v("”，按照模板格式录入数据。\n              ")],1)])],2),e._v(" "),a("el-step",{attrs:{title:"检查数据",icon:"el-icon-upload",description:"等待文件上传完毕后自动检查表格数据。"}},[a("template",{slot:"description"},[a("div",[e._v("等待文件上传完毕后自动检查表格数据。")])])],2),e._v(" "),a("el-step",{attrs:{title:"完成",icon:"el-icon-picture"}})],1),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo steps-btn",attrs:{action:e.uploadUrl(),accept:".xls","on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!0,"on-success":e.handleSuccess,"on-error":e.handleError,"before-remove":e.beforeRemove,limit:1,"on-exceed":e.handleExceed}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持文件格式：.xls 类型的文件，且不超过20M")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closciick}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("确 定")])],1)])],1),e._v(" "),a("crumb",{staticStyle:{padding:"0 5px"}},[a("div",{staticClass:"new--btn",attrs:{slot:"right"},on:{click:e.close},slot:"right"},[e._v("+ 新建")]),e._v(" "),a("div",{staticStyle:{float:"left","margin-right":"10px",color:"#03B187",cursor:"pointer"},attrs:{slot:"right",icon:"el-icon-plus"},on:{click:e.successdata},slot:"right"},[a("SvgIcon",{staticStyle:{float:"left",margin:"32px 5px 0 0"},attrs:{"icon-class":"icondaoru",size:"18px"}}),e._v(" 导入")],1)]),e._v(" "),a("div",{staticClass:"classManagement-tab"},[a("div",{staticClass:"classManagement-inp"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("span",{staticClass:"ssss"},[e._v("所属学院/部门：")]),e._v(" "),a("el-select",{staticClass:"pppp",attrs:{placeholder:"请选择院校"},on:{change:e.changes},model:{value:e.valuearr,callback:function(t){e.valuearr=t},expression:"valuearr"}},e._l(e.optionsarr,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("span",{staticClass:"sssss"},[e._v("教职工搜索：")]),e._v(" "),a("el-input",{staticClass:"pppp",attrs:{placeholder:"请输入教职工姓名/工号"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}}),e._v(" "),a("div",{staticClass:"search--btn",staticStyle:{margin:"6px 0 0 20px"},on:{click:e.onSubmit}},[e._v("搜索")])],1)],1),e._v(" "),[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{label:"职工号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.workNumber))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.genderVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"民族"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.ethnicityVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"政治面貌"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.politicalVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"学历"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.educationVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属学院"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.academyIdVal))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconbianji1"}}),e._v("  编辑\n            ")],1),e._v(" "),a("el-button",{staticStyle:{color:"#ff5858"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("SvgIcon",{attrs:{"icon-class":"iconshanchu"}}),e._v("  删除\n            ")],1)]}}])})],1)]],2),e._v(" "),a("div",[[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[15,30,40,50],"page-size":e.pageSize,layout:"prev, pager, next, jumper, sizes, total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]],2)],1)},staticRenderFns:[]};var c=a("C7Lr")(n,r,!1,function(e){a("7qdz")},null,null);t.default=c.exports},"7qdz":function(e,t){}});
//# sourceMappingURL=89.c960e57ef0c4403f3714.js.map