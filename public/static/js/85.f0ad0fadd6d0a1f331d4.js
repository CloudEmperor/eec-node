webpackJsonp([85],{Cmfa:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=t("M9A7"),o={name:"resetPasswords",data:function(){var e=this;return{stepIndex:0,verificationCode:!0,sendCode:60,codeTitle:"发送验证码",form:{userAccount:"",authCode:""},formPassword:{newPassword:"",confirmPassword:""},rules:{userAccount:[{required:!0,message:"请输入账号",trigger:"blur"}],authCode:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"}],newPassword:[{required:!0,validator:function(e,s,t){s||t(new Error("设置设置6至20位登录密码")),/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/.test(s)?t():t(new Error("密码6至20位，必须包含字母与数字"))},trigger:"blur"}],confirmPassword:[{required:!0,validator:function(s,t,r){t||r(new Error("请再次输入登录密码")),t===e.formPassword.newPassword?r():r(new Error("两次密码不一致"))},trigger:"blur"}]}}},methods:{sendVerificationCode:function(){this.form.userAccount?60===this.sendCode&&this.sendSecurityCode(this.form.userAccount):this.$notify({title:"warning",message:"请输入账号",type:"warning"})},countDown:function(){var e=this;setTimeout(function s(){e.codeTitle=e.sendCode+"秒后可重发",0===e.sendCode?(e.verificationCode=!0,e.sendCode=60,e.codeTitle="重新发送验证码"):(e.sendCode--,setTimeout(s,1e3))},1e3)},setUserAccount:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return!1;s.validateSecurityCode()})},setNewPassword:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return!1;var t={securityCode:s.form.authCode,userName:s.form.userAccount,newPassword:s.formPassword.newPassword};s.resetPassword(t)})},sendSecurityCode:function(e){var s=this,t=r.a.sendSecurityCode({userName:e});this.$get(t).then(function(e){1===e.status?(s.$notify.success({title:"success",duration:1500,message:e.message}),s.countDown()):s.$notify.error({title:"error",duration:1500,message:e.message})})},validateSecurityCode:function(){var e=this,s=r.a.validateSecurityCode({userName:this.form.userAccount,securityCode:this.form.authCode});this.$get(s).then(function(s){1===s.status?(e.$notify.success({title:"success",duration:1500,message:s.message}),e.stepIndex=1,e.$nextTick(function(){e.$refs.formPassword.resetFields()})):e.$notify.error({title:"error",duration:1500,message:s.message})})},resetPassword:function(e){var s=this,t=r.a.resetPassword;this.$put(t,e).then(function(e){1===e.status?(s.$notify.success({title:"success",duration:1500,message:e.message}),s.stepIndex=2):s.$notify.error({title:"error",duration:1500,message:e.message})})},restartLogin:function(){this.$router.replace({path:"/"})}}},a={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"reset-passwords-page"},[2!==e.stepIndex?t("div",{staticClass:"login-public reset-passwords"},[t("p",{staticClass:"reset-passwords_header"},[e._v("重置密码")]),e._v(" "),t("div",{staticClass:"reset-passwords_steps"},[t("el-steps",{attrs:{space:300,active:e.stepIndex,"finish-status":"success"}},[t("el-step",{attrs:{title:"验证身份"}}),e._v(" "),t("el-step",{attrs:{title:"设置新密码"}}),e._v(" "),t("el-step",{attrs:{title:"重置成功"}})],1)],1),e._v(" "),t("transition",{attrs:{name:"el-fade-in"}},[0===e.stepIndex?t("div",{staticClass:"reset-passwords_content"},[t("el-form",{ref:"form",staticClass:"login-ruleForm",attrs:{model:e.form,"status-icon":"",rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{prop:"userAccount"}},[t("el-input",{attrs:{autocomplete:"new-password",placeholder:"请输入账号"},model:{value:e.form.userAccount,callback:function(s){e.$set(e.form,"userAccount",s)},expression:"form.userAccount"}},[t("template",{slot:"prepend"},[t("SvgIcon",{attrs:{"icon-class":"iconzhanghao",size:"24px"}})],1)],2)],1),e._v(" "),t("el-form-item",{attrs:{prop:"authCode"}},[t("el-input",{attrs:{type:"password",autocomplete:"new-password",placeholder:"请输入邮箱验证码"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.setUserAccount("form")}},model:{value:e.form.authCode,callback:function(s){e.$set(e.form,"authCode",s)},expression:"form.authCode"}},[t("template",{slot:"prepend"},[t("SvgIcon",{attrs:{"icon-class":"iconyouxiang",size:"24px"}})],1),e._v(" "),t("template",{slot:"suffix"},[e.verificationCode?t("span",{staticClass:"auth-code",on:{click:e.sendVerificationCode}},[e._v(e._s(e.codeTitle))]):t("label",{staticClass:"count-down"},[e._v(e._s(e.sendCode)+"秒后可重发")])])],2)],1),e._v(" "),t("el-form-item",[t("el-button",{staticClass:"login-button",attrs:{type:"primary",size:"medium"},on:{click:function(s){return e.setUserAccount("form")}}},[e._v("下一步")])],1)],1)],1):e._e(),e._v(" "),1===e.stepIndex?t("div",{staticClass:"reset-passwords_content"},[t("el-form",{ref:"formPassword",staticClass:"login-ruleForm",attrs:{model:e.formPassword,"status-icon":"",rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{prop:"newPassword"}},[t("el-input",{attrs:{autocomplete:"new-password",placeholder:"设置设置6至20位登录密码"},model:{value:e.formPassword.newPassword,callback:function(s){e.$set(e.formPassword,"newPassword",s)},expression:"formPassword.newPassword"}},[t("template",{slot:"prepend"},[t("SvgIcon",{attrs:{"icon-class":"iconxinmima",size:"24px"}})],1)],2)],1),e._v(" "),t("el-form-item",{attrs:{prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"new-password",placeholder:"请再次输入登录密码"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.setNewPassword("formPassword")}},model:{value:e.formPassword.confirmPassword,callback:function(s){e.$set(e.formPassword,"confirmPassword",s)},expression:"formPassword.confirmPassword"}},[t("template",{slot:"prepend"},[t("SvgIcon",{attrs:{"icon-class":"iconxinmima",size:"24px"}})],1)],2)],1),e._v(" "),t("el-form-item",[t("el-button",{staticClass:"login-button",attrs:{type:"primary",size:"medium"},on:{click:function(s){return e.setNewPassword("formPassword")}}},[e._v("下一步")])],1)],1)],1):e._e()])],1):e._e(),e._v(" "),t("transition",{attrs:{name:"el-fade-in"}},[2===e.stepIndex?t("div",{staticClass:"reset-success"},[t("div",{staticClass:"reset-success_content"},[t("i",{staticClass:"el-icon-success"}),e._v(" "),t("p",[e._v("密码重置成功")]),e._v(" "),t("p",[e._v("请妥善保管您的账户信息")]),e._v(" "),t("el-button",{on:{click:e.restartLogin}},[e._v("重新登录")])],1)]):e._e()])],1)},staticRenderFns:[]};var n=t("C7Lr")(o,a,!1,function(e){t("T8c2")},null,null);s.default=n.exports},T8c2:function(e,s){}});
//# sourceMappingURL=85.f0ad0fadd6d0a1f331d4.js.map