{"version":3,"sources":["webpack:///src/views/evaluationAndFeedback/publish.vue","webpack:///./src/views/evaluationAndFeedback/publish.vue?3243","webpack:///./src/views/evaluationAndFeedback/publish.vue"],"names":["publish","name","components","Editor","data","pageTitle","times","introduction","roleOptions","selectRole","isIpLimit","form","type","formId","this","$route","query","id","startTime","endTIme","sendName","subject","html","rules","required","message","trigger","filterText","defaultProps","children","label","api","listEndEmailForRol","listEndShareForRole","created","shareForRole","mounted","watch","val","$refs","tree","filter","methods","radioChange","res","_this","url","$get","then","code","emailArr","realName","alumnus","expert","enterprise","stationArr","student","map","vo","index","specialtyName","specialtyList","v","n","className","classList","teacher","checkChange","node","c","d","countermand","getCheckedNodes","repeatFn","obj","_this2","self","forEach","push","arr","resArr","resetChecked","setCheckedKeys","timeChange","Object","utils","Date","parse","usePublish","formName","_this3","validate","valid","length","$message","stringify_default","$post","$notify","success","title","duration","setTimeout","$router","path","error","msg","filterNode","value","indexOf","unique","h","temp","i","evaluationAndFeedback_publish","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","ref","model","label-width","prop","range-separator","start-placeholder","end-placeholder","on","change","callback","$$v","expression","$set","icon-class","size","_e","click","placeholder","props","show-checkbox","node-key","filter-node-method","check-change","_l","key","_s","email","input-content","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/41.8bb307b4611eb3443ec0.js","sourcesContent":["<template>\r\n  <div class=\"center\">\r\n    <div class=\"center_content\">\r\n        <div class=\"center_breadcrumb\">\r\n            <crumb :data=\"pageTitle\"></crumb>\r\n        </div>\r\n        <div class=\"table-container publish\">\r\n             <el-form :model=\"form\" :rules=\"rules\" ref=\"form\" label-width=\"80px\">\r\n                <p class=\"small-title-tip tips\" >答题设置</p>\r\n                <el-form-item class=\"first\" label=\"设置开始/结束时间\" prop=\"name\">\r\n                     <el-date-picker\r\n                        v-model=\"times\"\r\n                        @change=\"timeChange\"\r\n                        type=\"daterange\"\r\n                        range-separator=\"-\"\r\n                        start-placeholder=\"设置开始时间\"\r\n                        end-placeholder=\"设置结束时间\">\r\n                        </el-date-picker>\r\n                </el-form-item>\r\n                <el-form-item label=\"答题限制\" prop=\"name\">\r\n                     <el-checkbox v-model=\"isIpLimit\">每个IP只能答题一次</el-checkbox>\r\n                </el-form-item>\r\n                <p class=\"small-title-tip tips\">分享方式</p>\r\n                    <el-radio-group v-model=\"form.type\" @change=\"radioChange\" class=\"share\">\r\n                        <el-radio :label=\"1\">\r\n                            <div class=\"share_way\">\r\n                                <SvgIcon icon-class=\"iconyouxiang\" size=\"35px\"></SvgIcon>\r\n                                <div class=\"share_way_txt\">\r\n                                    <label>邮件分享</label>\r\n                                    <i>通过邮件方式分享问卷</i>\r\n                                </div>\r\n                            </div>\r\n                        </el-radio>\r\n                        <el-radio :label=\"2\">\r\n                            <div class=\"share_way\">\r\n                                <SvgIcon icon-class=\"icondaochu\" size=\"35px\"></SvgIcon>\r\n                                <div class=\"share_way_txt\">\r\n                                    <label>链接分享</label>\r\n                                    <i>通过链接方式分享问卷</i>\r\n                                </div>\r\n                            </div>\r\n                        </el-radio>\r\n                        <el-radio :label=\"3\">\r\n                            <div class=\"share_way\">\r\n                                <SvgIcon icon-class=\"icondaochu\" size=\"35px\"></SvgIcon>\r\n                                <div class=\"share_way_txt\">\r\n                                    <label>系统内分享</label>\r\n                                    <i>通过系统推送</i>\r\n                                </div>\r\n                            </div>\r\n                        </el-radio>\r\n                    </el-radio-group>\r\n                <p  v-if=\"form.type !==2\" class=\"small-title-tip tips\">分享人群</p>\r\n                <div v-if=\"form.type ===1 || form.type ===3\" class=\"share-person\">\r\n                    <div class=\"share-person_head\"><el-button @click=\"resetChecked\" type=\"text\">全部清空</el-button></div>\r\n                    <div class=\"share-person_body\">\r\n                         <div class=\"lt\">\r\n                             <div class=\"lt_head\"><span class=\"sp\">联系人</span></div>\r\n                             <div class=\"lt_body\">\r\n                                 <el-input\r\n                                    placeholder=\"搜索联系人\"\r\n                                    v-model=\"filterText\">\r\n                                    </el-input>\r\n                                    <el-tree\r\n                                    class=\"filter-tree\"\r\n                                    :data=\"roleOptions\"\r\n                                    :props=\"defaultProps\"\r\n                                    :show-checkbox=\"true\"\r\n                                    node-key=\"id\"\r\n                                    @check-change=\"checkChange\"\r\n                                    :filter-node-method=\"filterNode\"\r\n                                    ref=\"tree\">\r\n                                    </el-tree>\r\n                             </div>\r\n                         </div>\r\n                         <div class=\"rt\">\r\n                             <span v-for=\"(vo, index) in selectRole\" :key=\"index\">{{vo.email}},{{vo.realName}}</span>\r\n                         </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"share-person\" v-if=\"form.type ===2\"></div>\r\n                <div  v-if=\"form.type ===1\">\r\n                    <p class=\"small-title-tip tips\">邮件内容</p>\r\n                    <el-form-item label=\"发件人\" prop=\"sendName\">\r\n                        <el-input v-model=\"form.sendName\"  placeholder=\"\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"主题\" prop=\"subject\">\r\n                        <el-input v-model=\"form.subject\"  placeholder=\"\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item >\r\n                        <editor v-model=\"form.html\"  :input-content=\"introduction\"> </editor>                                         \r\n                    </el-form-item>\r\n                </div>\r\n             </el-form>\r\n             <div  class=\"footer\">\r\n                <el-button @click=\"usePublish('form')\" type=\"primary\">发布问卷</el-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport Editor from '../components/Editor'\r\nimport {formatDate} from '@/utils/utils.js'\r\n\r\nexport default {\r\n name: 'Publish',\r\n components: {Editor},\r\n data() {\r\n return {\r\n   pageTitle:['问卷', '发起问卷'],\r\n   times:[], \r\n   introduction:'',\r\n   roleOptions:[],\r\n   selectRole:[],\r\n   isIpLimit:true,\r\n   form:{   \r\n       type:1,\r\n       formId:this.$route.query.id || 0,\r\n       startTime:'',\r\n       endTIme:'',\r\n       isIpLimit:'1',\r\n       data:'',\r\n       sendName:'',\r\n       subject:'',\r\n       html:''\r\n   },\r\n   rules:{\r\n      sendName: [ { required: true, message:'请填写发件人', trigger: 'blur' } ], \r\n      subject: [ { required: true, message:'请填写主题', trigger: 'blur' } ],      \r\n        \r\n   },\r\n   filterText: '',\r\n   defaultProps: {\r\n        children: 'children',\r\n        label: 'realName'\r\n    },\r\n    api:{\r\n        listEndEmailForRol:'/form/rest/FormMainBaseBusiness/listEndEmailForRole/v1', //邮件分享人群\r\n        listEndShareForRole:'/form/rest/FormMainBaseBusiness/listEndShareForRole/v1', //站内人群\r\n        publish:'/form/rest/FormMainBaseBusiness/publish/v1'\r\n    }\r\n }\r\n },\r\n created(){\r\n     this.shareForRole()\r\n },\r\n mounted(){},\r\n watch: {\r\n      filterText(val) {\r\n        this.$refs.tree.filter(val);\r\n      }\r\n    },\r\n methods:{\r\n     radioChange(res){\r\n       if(this.form.type !==2){\r\n              this.roleOptions=[]\r\n              this.selectRole=[]\r\n              this.shareForRole()   \r\n       }\r\n     },\r\n     shareForRole(){\r\n         const url = this.form.type === 1 ? this.api.listEndEmailForRol : this.api.listEndShareForRole\r\n         this.$get(url).then(res=>{\r\n           if(res.code === 200){\r\n               if(this.form.type === 1){\r\n                   const emailArr=[\r\n                            {\r\n                                id: '001',\r\n                                realName: '校友',\r\n                                children:res.data.alumnus || []\r\n                            }, \r\n                            {\r\n                                id: '002',\r\n                                realName: '专家',\r\n                                children:res.data.expert || []\r\n                            },\r\n                            {\r\n                                id: '003',\r\n                                realName: '企业',\r\n                                children:res.data.enterprise || []\r\n                            }\r\n                        ]\r\n                    this.roleOptions=emailArr\r\n               }else{\r\n                   const studentArr=res.data.student.map((vo, index) =>{\r\n                        return {                       \r\n                                    id: `001${index}`,\r\n                                    type:'student',\r\n                                    realName: vo.specialtyName,\r\n                                    children:vo.specialtyList.map((v, n) =>{\r\n                                        return {\r\n                                            id: `001${index}${n}`,\r\n                                            type:'student',\r\n                                            realName: v.className,\r\n                                            children:v.classList || []\r\n                                        }\r\n                                    })        \r\n                        }\r\n                   })\r\n              \r\n                   const stationArr=[\r\n                            {\r\n                                id: '001',\r\n                                realName: '学生',\r\n                                type:'student',\r\n                                children:studentArr\r\n                            }, \r\n                            {\r\n                                id: '002',\r\n                                realName: '教师',   \r\n                                children:res.data.teacher || []\r\n                            },\r\n                            // {\r\n                            //     id: '003',\r\n                            //     realName: '专家',\r\n                            //     children:res.data.zhuanjia || []\r\n                            // }\r\n                        ]\r\n                    this.roleOptions=stationArr\r\n               }\r\n           } \r\n         })\r\n     },\r\n     checkChange(node, c, d){ \r\n         const _self=this\r\n        _self.selectRole=_self.countermand(_self.$refs.tree.getCheckedNodes())    \r\n     },\r\n      repeatFn(obj) {\r\n        const self=this\r\n        if(obj.children){\r\n            obj.children.forEach(vo => {\r\n                if (vo.children) {\r\n                        this.repeatFn(vo)\r\n                }else{\r\n                    self.selectRole.push(vo)\r\n                }\r\n            })\r\n        }else{\r\n            self.selectRole.push(obj)\r\n        }         \r\n     },\r\n     countermand(arr){ \r\n         const resArr=[]\r\n        arr.forEach(vo=>{\r\n            if(!vo.children){\r\n                resArr.push(vo)\r\n            }\r\n        })\r\n        return resArr \r\n     },\r\n     resetChecked(){\r\n          this.selectRole=[];\r\n          this.$refs.tree.setCheckedKeys([]);\r\n     },\r\n     timeChange(){\r\n         this.form.startTime=formatDate(Date.parse(this.times[0]), 'yyyy-MM-dd')\r\n         this.form.endTIme=formatDate(Date.parse(this.times[1]), 'yyyy-MM-dd')\r\n     },\r\n     usePublish(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          if(this.selectRole.length ===0 && this.form.type !==2){\r\n              this.$message('请选择分享人')\r\n              return\r\n          }\r\n         \r\n          this.form.data= this.form.type ===2 ? '' : JSON.stringify(this.selectRole);\r\n          this.form.isIpLimit= this.isIpLimit ? '1' : '0';\r\n          \r\n          this.$post(this.api.publish, this.form).then(res =>{\r\n              if(res.code ===200){\r\n                   this.$notify.success({\r\n                        title: 'success',\r\n                        duration:1500,\r\n                        message: '发布成功'                     \r\n                        })\r\n                  setTimeout(()=>{\r\n                        this.$router.push({\r\n                        path:  this.form.type ===2 ? '/evaluationAndFeedback/addressShare' : '/evaluationAndFeedback/researchProgress',\r\n                        query:{\r\n                           type:'process',\r\n                           id:this.form.formId\r\n                        }\r\n                     }) \r\n                  },800)      \r\n              }else{\r\n                this.$notify.error({\r\n                  title: 'error',\r\n                  duration:1500,\r\n                  message: res.msg\r\n               })\r\n              }\r\n          })\r\n        }\r\n      });\r\n    },\r\n     filterNode(value, data) {\r\n        if (!value) return true;\r\n        return data.realName.indexOf(value) !== -1;\r\n      },\r\n     unique(arr) {\r\n        let h = {};\r\n        let temp = [];\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (!h[arr[i].id]) {\r\n                h[arr[i].id] = true;\r\n                temp.push(arr[i]);\r\n            }\r\n        }\r\n        return temp;\r\n    }\r\n\r\n }\r\n}\r\n</script>\r\n\r\n<style lang='scss'>\r\n @import '../../styles/center.scss';\r\n .publish{\r\n     padding-left: 20px;\r\n     .first{\r\n         .el-form-item__label{\r\n             width:140px !important;\r\n         }\r\n     }\r\n     .tips{\r\n         border:0;\r\n         margin:0;\r\n     }\r\n     .share{\r\n         padding-left: 10px;\r\n         .el-radio__input{\r\n            margin-bottom: 25px;\r\n         }\r\n         .el-radio__inner{\r\n             border-color:#039f7a;\r\n         }\r\n         .is-checked .el-radio__inner{\r\n             background: #039f7a;\r\n         }\r\n         .is-checked + .el-radio__label{\r\n             .share_way{\r\n                 background: #039f7a;\r\n                color:#fff;\r\n             }       \r\n         }\r\n         .share_way{\r\n            width:205px;\r\n            height:75px;\r\n            background-color: #e6f7f3;\r\n            box-sizing: border-box;\r\n            border:1px solid #039f7a;\r\n            display:inline-flex;\r\n            justify-content: center;\r\n            align-items:center;\r\n            color:#039f7a;\r\n           .share_way_txt{\r\n              display:inline-flex;\r\n              flex-direction:column;\r\n              justify-content: center;\r\n              margin-left:10px;\r\n              label{\r\n                  font-size:14px;              \r\n              }\r\n              i{\r\n                font-style: normal;\r\n                font-size:12px;             \r\n              }\r\n           }\r\n        }\r\n     }\r\n     .share-person{\r\n          height:522px;\r\n         background:#fff;\r\n        .share-person_head{\r\n            height:40px;\r\n            .el-button{\r\n                float:right;\r\n            }\r\n        }\r\n        .share-person_body{\r\n            border:1px solid #DCDFE6;\r\n            height:460px;\r\n            .lt{\r\n                width:200px;\r\n                height:100%;\r\n                overflow-y:auto;\r\n                border-right:1px solid #DCDFE6;\r\n                float:left;\r\n                .lt_head{\r\n                    height:40px;\r\n                    background:#DCDFE6;\r\n                    font-size:12px;\r\n                    display:flex;\r\n                    justify-content: space-between;\r\n                    align-items: center;\r\n                    padding:0 10px;\r\n                    .sp{\r\n                        display:inline;                                   \r\n                    }\r\n                    .el-button{\r\n                        font-size:12px;                    \r\n                    }\r\n                }\r\n                .lt_body{\r\n                    height:420px;\r\n                    overflow:auto;\r\n                    background:#fff;\r\n                }\r\n            }\r\n            .rt{\r\n                width: calc(100% - 222px);\r\n                height: 440px;\r\n                overflow-y:auto;\r\n                float:left;\r\n                padding:10px;\r\n                background: #fff;\r\n                span{\r\n                    display:inline-block;\r\n                    color:#999;\r\n                    font-size:12px;\r\n                    margin:10px 10px 0 0;\r\n                }\r\n            }\r\n        }\r\n     }\r\n   .footer{\r\n     height:40px;\r\n     position:relative;\r\n     .el-button{\r\n         background-color: #03B187;\r\n         border-color: #03B187;\r\n        position: absolute;\r\n        left: 50%;\r\n     }\r\n   } \r\n }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/evaluationAndFeedback/publish.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"center\"},[_c('div',{staticClass:\"center_content\"},[_c('div',{staticClass:\"center_breadcrumb\"},[_c('crumb',{attrs:{\"data\":_vm.pageTitle}})],1),_vm._v(\" \"),_c('div',{staticClass:\"table-container publish\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"80px\"}},[_c('p',{staticClass:\"small-title-tip tips\"},[_vm._v(\"答题设置\")]),_vm._v(\" \"),_c('el-form-item',{staticClass:\"first\",attrs:{\"label\":\"设置开始/结束时间\",\"prop\":\"name\"}},[_c('el-date-picker',{attrs:{\"type\":\"daterange\",\"range-separator\":\"-\",\"start-placeholder\":\"设置开始时间\",\"end-placeholder\":\"设置结束时间\"},on:{\"change\":_vm.timeChange},model:{value:(_vm.times),callback:function ($$v) {_vm.times=$$v},expression:\"times\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"答题限制\",\"prop\":\"name\"}},[_c('el-checkbox',{model:{value:(_vm.isIpLimit),callback:function ($$v) {_vm.isIpLimit=$$v},expression:\"isIpLimit\"}},[_vm._v(\"每个IP只能答题一次\")])],1),_vm._v(\" \"),_c('p',{staticClass:\"small-title-tip tips\"},[_vm._v(\"分享方式\")]),_vm._v(\" \"),_c('el-radio-group',{staticClass:\"share\",on:{\"change\":_vm.radioChange},model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", $$v)},expression:\"form.type\"}},[_c('el-radio',{attrs:{\"label\":1}},[_c('div',{staticClass:\"share_way\"},[_c('SvgIcon',{attrs:{\"icon-class\":\"iconyouxiang\",\"size\":\"35px\"}}),_vm._v(\" \"),_c('div',{staticClass:\"share_way_txt\"},[_c('label',[_vm._v(\"邮件分享\")]),_vm._v(\" \"),_c('i',[_vm._v(\"通过邮件方式分享问卷\")])])],1)]),_vm._v(\" \"),_c('el-radio',{attrs:{\"label\":2}},[_c('div',{staticClass:\"share_way\"},[_c('SvgIcon',{attrs:{\"icon-class\":\"icondaochu\",\"size\":\"35px\"}}),_vm._v(\" \"),_c('div',{staticClass:\"share_way_txt\"},[_c('label',[_vm._v(\"链接分享\")]),_vm._v(\" \"),_c('i',[_vm._v(\"通过链接方式分享问卷\")])])],1)]),_vm._v(\" \"),_c('el-radio',{attrs:{\"label\":3}},[_c('div',{staticClass:\"share_way\"},[_c('SvgIcon',{attrs:{\"icon-class\":\"icondaochu\",\"size\":\"35px\"}}),_vm._v(\" \"),_c('div',{staticClass:\"share_way_txt\"},[_c('label',[_vm._v(\"系统内分享\")]),_vm._v(\" \"),_c('i',[_vm._v(\"通过系统推送\")])])],1)])],1),_vm._v(\" \"),(_vm.form.type !==2)?_c('p',{staticClass:\"small-title-tip tips\"},[_vm._v(\"分享人群\")]):_vm._e(),_vm._v(\" \"),(_vm.form.type ===1 || _vm.form.type ===3)?_c('div',{staticClass:\"share-person\"},[_c('div',{staticClass:\"share-person_head\"},[_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":_vm.resetChecked}},[_vm._v(\"全部清空\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"share-person_body\"},[_c('div',{staticClass:\"lt\"},[_c('div',{staticClass:\"lt_head\"},[_c('span',{staticClass:\"sp\"},[_vm._v(\"联系人\")])]),_vm._v(\" \"),_c('div',{staticClass:\"lt_body\"},[_c('el-input',{attrs:{\"placeholder\":\"搜索联系人\"},model:{value:(_vm.filterText),callback:function ($$v) {_vm.filterText=$$v},expression:\"filterText\"}}),_vm._v(\" \"),_c('el-tree',{ref:\"tree\",staticClass:\"filter-tree\",attrs:{\"data\":_vm.roleOptions,\"props\":_vm.defaultProps,\"show-checkbox\":true,\"node-key\":\"id\",\"filter-node-method\":_vm.filterNode},on:{\"check-change\":_vm.checkChange}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"rt\"},_vm._l((_vm.selectRole),function(vo,index){return _c('span',{key:index},[_vm._v(_vm._s(vo.email)+\",\"+_vm._s(vo.realName))])}),0)])]):_vm._e(),_vm._v(\" \"),(_vm.form.type ===2)?_c('div',{staticClass:\"share-person\"}):_vm._e(),_vm._v(\" \"),(_vm.form.type ===1)?_c('div',[_c('p',{staticClass:\"small-title-tip tips\"},[_vm._v(\"邮件内容\")]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"发件人\",\"prop\":\"sendName\"}},[_c('el-input',{attrs:{\"placeholder\":\"\"},model:{value:(_vm.form.sendName),callback:function ($$v) {_vm.$set(_vm.form, \"sendName\", $$v)},expression:\"form.sendName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"主题\",\"prop\":\"subject\"}},[_c('el-input',{attrs:{\"placeholder\":\"\"},model:{value:(_vm.form.subject),callback:function ($$v) {_vm.$set(_vm.form, \"subject\", $$v)},expression:\"form.subject\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('editor',{attrs:{\"input-content\":_vm.introduction},model:{value:(_vm.form.html),callback:function ($$v) {_vm.$set(_vm.form, \"html\", $$v)},expression:\"form.html\"}})],1)],1):_vm._e()],1),_vm._v(\" \"),_c('div',{staticClass:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.usePublish('form')}}},[_vm._v(\"发布问卷\")])],1)],1)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-e985d220\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/evaluationAndFeedback/publish.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e985d220\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./publish.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./publish.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./publish.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e985d220\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./publish.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/evaluationAndFeedback/publish.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}